# vdh_flickr v0.8.13a
# Shows your flickr.com pictures in TextPattern.
# Ralph von der Heyden
# http://www.rvdh.net/vdh_flickr

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YTo5OntzOjc6InZlcnNpb24iO3M6NzoiMC44LjEzYSI7czo2OiJhdXRob3IiO3M6MjA6IlJh
bHBoIHZvbiBkZXIgSGV5ZGVuIjtzOjEwOiJhdXRob3JfdXJpIjtzOjMwOiJodHRwOi8vd3d3
LnJ2ZGgubmV0L3ZkaF9mbGlja3IiO3M6MTE6ImRlc2NyaXB0aW9uIjtzOjQ2OiJTaG93cyB5
b3VyIGZsaWNrci5jb20gcGljdHVyZXMgaW4gVGV4dFBhdHRlcm4uIjtzOjQ6InR5cGUiO2k6
MDtzOjQ6Im5hbWUiO3M6MTA6InZkaF9mbGlja3IiO3M6NDoiaGVscCI7czoxODY6Igk8aDE+
dmRoX2ZsaWNrciBkb2N1bWVudGF0aW9uPC9oMT4KCgk8cD5QbGVhc2Ugc2VlIHRoZSA8YSBo
cmVmPSJodHRwOi8vY29kZS5nb29nbGUuY29tL3AvdmRoZmxpY2tyL3dpa2kvRG9jdW1lbnRh
dGlvbiI+dmRoX2ZsaWNrciB3aWtpIG9uIEdvb2dsZSBDb2RlPC9hPiBmb3IgZGV0YWlsbGVk
IGRvY3VtZW50YXRpb24uPC9wPiI7czo0OiJjb2RlIjtzOjQ1ODEyOiIvKiB2ZGhfZmxpY2ty
IFRleHRwYXR0ZXJuIHBsdWdpbgoqCiogQXV0aG9yOiBSYWxwaCB2b24gZGVyIEhleWRlbiA8
ZmxpY2tyQHJ2ZGgubmV0PgoqICAgICAgICAgaHR0cDovL3d3dy5ydmRoLm5ldC92ZGhfZmxp
Y2tyCioKKgoqIExpY2Vuc2U6IEdQTAoqCiovCgovKiBIZXJlIHlvdSBjYW4gdHJhbnNsYXRl
IG9yIGFkanVzdCB0aGluZ3MgYXMgeW91IGxpa2UuCioKKi8KZ2xvYmFsICR0ZXh0OwokdGV4
dCA9IGFycmF5KCk7CiR0ZXh0WydlcnJvcl9tZXNzYWdlJ10gPSAnRmFpbGVkIHRvIGNvbm5l
Y3QgdG8gZmxpY2tyLmNvbSEnOwokdGV4dFsnbGF0ZXN0J10gPSAnTXkgbGF0ZXN0IFBpY3R1
cmVzLi4uJzsKCmdsb2JhbCAkY2xlYW5fdXJsczsKLy8kY2xlYW5fdXJscyA9IDE7CgpnbG9i
YWwgJG5zaWQ7Ci8vICRuc2lkID0gJzEyMzQ1Njc4QE4wMCc7CgoKY2xhc3MgVmRoX0ZsaWNr
ciB7Cgl2YXIgJGFwaV9rZXksICRlbWFpbCwgJG5zaWQsICRwYXNzd29yZCwgJHVzZXJkYXRh
LCAkeG1sLCAkZm9ybSwgJHVzZV9hcnRpY2xldXJsOwoKCWZ1bmN0aW9uIFZkaF9GbGlja3Io
JHBhcmFtcykgewoJCSR0aGlzLT5hcGlfa2V5ID0gJ2MzNGU0MGRjNzA3ZjliYzUyNzM2ZGJh
NTY4MTE4OTNmJzsKCQlpZihpc3NldCgkcGFyYW1zWydlcnJvcl9tZXNzYWdlJ10pKSB7CgkJ
CSRHTE9CQUxTWyd0ZXh0J11bJ2Vycm9yX21lc3NhZ2UnXSA9ICRwYXJhbXNbJ2Vycm9yX21l
c3NhZ2UnXTsKCQl9CgkJaWYoaXNzZXQoJHBhcmFtc1snY2xlYW5fdXJscyddKSkgewoJCQkk
R0xPQkFMU1snY2xlYW5fdXJscyddID0gJHBhcmFtc1snY2xlYW5fdXJscyddOwoJCX0KCQkk
bWFpbnZlcnNpb24gPSBzdHJ0b2sgKFBIUF9WRVJTSU9OLCIuIik7CgkJaWYoISgkbWFpbnZl
cnNpb24gPj0gNSkpIHsKCQkJJEdMT0JBTFNbJ3VzZV9waHA0J10gPSAxOwoJCX0KCQlpZiAo
aXNzZXQoJHBhcmFtc1snZW1haWwnXSkpICR0aGlzLT5lbWFpbCA9ICRwYXJhbXNbJ2VtYWls
J107CgkJKGlzc2V0KCRHTE9CQUxTWyduc2lkJ10pKT8KCQkkdGhpcy0+bnNpZCA9ICRHTE9C
QUxTWyduc2lkJ106CgkJJHRoaXMtPm5zaWQgPSAkcGFyYW1zWyduc2lkJ107CgkJaWYgKCRH
TE9CQUxTWydpc19hcnRpY2xlX2xpc3QnXSA9PT0gZmFsc2UpICR0aGlzLT51c2VfYXJ0aWNs
ZXVybCA9IHRydWU7CgkJaWYgKGlzc2V0KCRwYXJhbXNbJ3VzZV9hcnRpY2xldXJsJ10pIGFu
ZCAkcGFyYW1zWyd1c2VfYXJ0aWNsZXVybCddID09IDEpICR0aGlzLT51c2VfYXJ0aWNsZXVy
bCA9IHRydWU7CgkJaWYgKGlzc2V0KCRwYXJhbXNbJ3VzZV9hcnRpY2xldXJsJ10pIGFuZCAk
cGFyYW1zWyd1c2VfYXJ0aWNsZXVybCddID09IDApICR0aGlzLT51c2VfYXJ0aWNsZXVybCA9
IGZhbHNlOwoJCWlmICghaXNzZXQoJHRoaXMtPm5zaWQpKSAkdGhpcy0+Z2V0TnNpZCgpOwoJ
CSR0aGlzLT51c2VyZGF0YSA9ICcmYXBpX2tleT0nIC4gJHRoaXMtPmFwaV9rZXkgLiAnJnVz
ZXJfaWQ9JyAuICR0aGlzLT5uc2lkOwoJCWlmIChpc3NldCgkcGFyYW1zWydwYXNzd29yZCdd
KSkgewoJCQkkdGhpcy0+cGFzc3dvcmQgPSAkcGFyYW1zWydwYXNzd29yZCddOwoJCQkkdGhp
cy0+dXNlcmRhdGEgLj0gJyZwYXNzd29yZD0nIC4gJHRoaXMtPnBhc3N3b3JkOwoJCX0KCQlp
ZiAoaXNzZXQoJHRoaXMtPmVtYWlsKSkgJHRoaXMtPnVzZXJkYXRhIC49ICcmZW1haWw9JyAu
ICR0aGlzLT5lbWFpbDsKCX0KCglmdW5jdGlvbiBnZXROc2lkKCkgewoJCSRtZXRob2QgPSAn
ZmxpY2tyLnBlb3BsZS5maW5kQnlFbWFpbCZhcGlfa2V5PScgLiAkdGhpcy0+YXBpX2tleSAu
ICcmZmluZF9lbWFpbD0nIC4gJHRoaXMtPmVtYWlsOwoJCSR0aGlzLT54bWwgPSBuZXcgRmxp
Y2tyKCRtZXRob2QpOwoJCWlmKCR0aGlzLT54bWwtPmlzVmFsaWQoKSkgewoJCQkkdGhpcy0+
bnNpZCA9IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCcvcnNwL3VzZXIvQGlkJykp
OwoJCX0KCX0KCglmdW5jdGlvbiBtYWtlUmVxdWVzdCgkcGFyYW1ldGVycykgewoJCSRrZXlz
ID0gYXJyYXlfa2V5cygkcGFyYW1ldGVycyk7CgkJaWYgKCRHTE9CQUxTWydwZXJtbGlua19t
b2RlJ10gPT0gJ21lc3N5JykgewoJCQkoJHRoaXMtPnVzZV9hcnRpY2xldXJsKT8KCQkJJGh0
bWwgPSBwZXJtbGlua3VybCgkR0xPQkFMU1sndGhpc2FydGljbGUnXSk6CgkJCSRodG1sID0g
aHUuJz9zPScudXJsZW5jb2RlKCRHTE9CQUxTWydzJ10pOwoJCQlmb3IoJGkgPSAwOyAkaSA8
IHNpemVvZigkcGFyYW1ldGVycyk7ICRpKyspIHsKCQkJCSRodG1sIC49ICcmYW1wOycgLiAk
a2V5c1skaV0gLiAnPScgLiAkcGFyYW1ldGVyc1ska2V5c1skaV1dOwoJCQl9CgkJCXJldHVy
biAkaHRtbDsKCQl9CgkJZWxzZSBpZiAoJEdMT0JBTFNbJ2NsZWFuX3VybHMnXSkgewoJCQko
JHRoaXMtPnVzZV9hcnRpY2xldXJsKT8KCQkJJGh0bWwgPSBwZXJtbGlua3VybCgkR0xPQkFM
U1sndGhpc2FydGljbGUnXSk6CgkJCSRodG1sID0gaHUudXJsZW5jb2RlKCRHTE9CQUxTWydz
J10pOwoJCQlmb3IoJGkgPSAwOyAkaSA8IHNpemVvZigkcGFyYW1ldGVycyk7ICRpKyspIHsK
CQkJCSRodG1sIC49ICcvJyAuICRrZXlzWyRpXSAuICcvJyAuICRwYXJhbWV0ZXJzWyRrZXlz
WyRpXV07CgkJCX0KCQkJcmV0dXJuICRodG1sOwoJCX0KCQllbHNlIHsKCQkJKCR0aGlzLT51
c2VfYXJ0aWNsZXVybCk/CgkJCSRodG1sID0gcGVybWxpbmt1cmwoJEdMT0JBTFNbJ3RoaXNh
cnRpY2xlJ10pIC4gJy8/JyAuICRrZXlzWzBdIC4gJz0nIC4kcGFyYW1ldGVyc1ska2V5c1sw
XV06CgkJCSRodG1sID0gaHUudXJsZW5jb2RlKCRHTE9CQUxTWydzJ10pIC4gJy8/JyAuICRr
ZXlzWzBdIC4gJz0nIC4kcGFyYW1ldGVyc1ska2V5c1swXV07CgkJCWZvcigkaSA9IDE7ICRp
IDwgc2l6ZW9mKCRwYXJhbWV0ZXJzKTsgJGkrKykgewoJCQkJJGh0bWwgLj0gJyZhbXA7JyAu
ICRrZXlzWyRpXSAuICc9JyAuICRwYXJhbWV0ZXJzWyRrZXlzWyRpXV07CgkJCX0KCQl9CgkJ
cmV0dXJuICRodG1sOwoJfQoKCWZ1bmN0aW9uIGdldFBob3RvVXJsKCRwaG90bywgJHNpemUp
IHsKCQkkZmFybSA9ICRwaG90b1snZmFybSddOwoJCSRzZXJ2ZXIgPSAkcGhvdG9bJ3NlcnZl
ciddOwoJCSRpZCA9IChpc3NldCgkcGhvdG9bJ3ByaW1hcnknXSkpPyAkcGhvdG9bJ3ByaW1h
cnknXSA6ICRwaG90b1snaWQnXTsKCQkkc2VjcmV0ID0gJHBob3RvWydzZWNyZXQnXTsKCQkk
Zm9ybWF0ID0gImpwZyI7CgkJJGltZ3NpemUgPSAoIm4iICE9ICRzaXplKT8gIl8iIC4gJHNp
emUgOiAiIjsKCQlpZiAoIm8iID09ICRzaXplKQoJCXsKCQkJJHNlY3JldCA9ICRwaG90b1sn
b3JpZ2luYWxfc2VjcmV0J107CgkJCSRmb3JtYXQgPSAkcGhvdG9bJ29yaWdpbmFsX2Zvcm1h
dCddOwoJCX0KCQkkaW1nX3VybCA9ICJodHRwOi8vZmFybSR7ZmFybX0uc3RhdGljLmZsaWNr
ci5jb20vJHtzZXJ2ZXJ9LyR7aWR9XyR7c2VjcmV0fSR7aW1nc2l6ZX0uJHtmb3JtYXR9IjsK
CQlyZXR1cm4gJGltZ191cmw7Cgl9CgoJZnVuY3Rpb24gX190b1N0cmluZygpIHsKCQlyZXR1
cm4gJHRoaXMtPm5zaWQ7Cgl9Cn0KCgpjbGFzcyBHYWxsZXJ5IGV4dGVuZHMgVmRoX0ZsaWNr
ciB7Cgl2YXIgJHhtbCwgJGksICRzZXQsICRzZXRfcHJldmlld19zaXplLCAkbW9kZTsKCXZh
ciAkc2V0c19wZXJfcGFnZSwgJHBhZ2UsICRwcmV2aW91c19wYWdlLCAkbmV4dF9wYWdlLCAk
bGFzdHBhZ2UsICRudW1iZXJfb2Zfc2V0czsKCXZhciAkZXhjZXB0aW9ucyA9IGFycmF5KCk7
Cgl2YXIgJHNldHMgPSBhcnJheSgpOwoKCWZ1bmN0aW9uIEdhbGxlcnkoJHBhcmFtcykgewoJ
CSR0aGlzLT5WZGhfRmxpY2tyKCRwYXJhbXMpOwoJCWlmIChpc3NldCgkcGFyYW1zWydleGNl
cHQnXSkpICR0aGlzLT5leGNlcHRpb25zID0gZXhwbG9kZSgiLCIsICRwYXJhbXNbJ2V4Y2Vw
dCddKTsKCQkoaXNzZXQoJHBhcmFtc1snc2V0X3ByZXZpZXdfc2l6ZSddKSk/CgkJJHRoaXMt
PnNldF9wcmV2aWV3X3NpemUgPSBAJHBhcmFtc1snc2V0X3ByZXZpZXdfc2l6ZSddOgoJCSR0
aGlzLT5zZXRfcHJldmlld19zaXplID0gJ20nOwoJCShpc3NldCgkX0dFVFsncGFnZSddKSk/
CgkJJHRoaXMtPnBhZ2UgPSAkX0dFVFsncGFnZSddOgoJCSR0aGlzLT5wYWdlID0gMTsKCQko
IWVtcHR5KCRwYXJhbXNbJ21vZGUnXSkpPwoJCSR0aGlzLT5tb2RlID0gJHBhcmFtc1snbW9k
ZSddOgoJCSR0aGlzLT5tb2RlID0gJ2FsbCc7CgkJJHRoaXMtPmdldFNldHMoJHBhcmFtcyk7
CgkJaWYgKGlzc2V0KCRwYXJhbXNbJ3NldHNfcGVyX3BhZ2UnXSkpIHsKCQkJJHRoaXMtPnNl
dHNfcGVyX3BhZ2UgPSAkcGFyYW1zWyd0aHVtYnNfcGVyX3BhZ2UnXTsKCQkJJHRoaXMtPmxh
c3RwYWdlID0gY2VpbCgkdGhpcy0+bnVtYmVyX29mX3NldHMgLyAkdGhpcy0+c2V0c19wZXJf
cGFnZSk7CgkJCWlmICgkdGhpcy0+cGFnZS0xID49IDEpIHsKCQkJCSR0aGlzLT5wcmV2aW91
c19wYWdlID0gJHRoaXMtPnBhZ2UgLSAxOwoJCQl9CgkJCWVsc2UgewoJCQkJJHRoaXMtPnBy
ZXZpb3VzX3BhZ2UgPSAkdGhpcy0+bGFzdHBhZ2U7CgkJCX0KCQkJaWYgKCR0aGlzLT5wYWdl
KzEgPD0gJHRoaXMtPmxhc3RwYWdlKSB7CgkJCQkkdGhpcy0+bmV4dF9wYWdlID0gJHRoaXMt
PnBhZ2UgKyAxOwoJCQl9CgkJCWVsc2UgewoJCQkJJHRoaXMtPm5leHRfcGFnZSA9ICAxOwoJ
CQl9CgkJfQoJCWlmIChpc3NldCgkcGFyYW1zWydzZXRfZm9ybSddKSkgewoJCQkkdGhpcy0+
Zm9ybSA9IGZldGNoKCdGb3JtJywndHhwX2Zvcm0nLCJuYW1lIiwkcGFyYW1zWydzZXRfZm9y
bSddKTsKCQl9CgkJZWxzZSB7CgkJCSR0aGlzLT5mb3JtID0gJwoJCQk8ZGl2IGNsYXNzPSJz
ZXRwcmV2aWV3Ij4KCQkJPGRpdiBjbGFzcz0idGh1bWJuYWlsIj4KCQkJPHR4cDp2ZGhfZmxp
Y2tyX3NldF9saW5rIHRpdGxlPSJQcm9jZWVkIHRvIHRoaXMgZ2FsbGVyeSI+PHR4cDp2ZGhf
ZmxpY2tyX3NldF9pbWcgdGl0bGU9IlByb2NlZWQgdG8gdGhpcyBnYWxsZXJ5IiAvPjwvdHhw
OnZkaF9mbGlja3Jfc2V0X2xpbms+CgkJCTwvZGl2PgoJCQk8ZGl2PgoJCQk8aDMgY2xhc3M9
InRpdGxlIj48dHhwOnZkaF9mbGlja3Jfc2V0X2xpbmsgdGl0bGU9IlByb2NlZWQgdG8gdGhp
cyBnYWxsZXJ5Ij48dHhwOnZkaF9mbGlja3Jfc2V0X3RpdGxlIC8+PC90eHA6dmRoX2ZsaWNr
cl9zZXRfbGluaz48L2gzPgoJCQk8aDQgY2xhc3M9Im51bWJlcl9vZl9waG90b3MiPjx0eHA6
dmRoX2ZsaWNrcl9zZXRfbnVtYmVyX29mX3Bob3RvcyAvPiBQaG90b3M8L2g0PgoJCQk8cCBj
bGFzcz0ic2V0X2Rlc2NyaXB0aW9uIj48dHhwOnZkaF9mbGlja3Jfc2V0X2Rlc2NyaXB0aW9u
IC8+PC9wPgoJCQk8L2Rpdj4KCQkJPGRpdiBzdHlsZT0iY2xlYXI6Ym90aDsiPjwvZGl2PgoJ
CQk8L2Rpdj4nOwoJCX0KCX0KCglmdW5jdGlvbiBnZXRTZXRzKCRwYXJhbXMpIHsKCQkkbWV0
aG9kID0gJ2ZsaWNrci5waG90b3NldHMuZ2V0TGlzdCcgLiAkdGhpcy0+dXNlcmRhdGE7CgkJ
JHRoaXMtPnhtbCA9IG5ldyBGbGlja3IoJG1ldGhvZCk7CgkJaWYoJHRoaXMtPnhtbC0+aXNW
YWxpZCgpKSB7CgkJCSRpPTE7CgkJCWZvcmVhY2goJHRoaXMtPnhtbC0+eHBhdGgoJy9yc3Av
cGhvdG9zZXRzL3Bob3Rvc2V0JykgYXMgJHBob3Rvc2V0KSB7CgkJCQkkc2V0X2lkID0gYXJy
YXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoIi9yc3AvcGhvdG9zZXRzL3Bob3Rvc2V0WyRp
XS9AaWQiKSk7CgkJCQlpZigkdGhpcy0+bW9kZT09J2FsbCcpIHsKCQkJCQlpZighaW5fYXJy
YXkoJHNldF9pZCwgJHRoaXMtPmV4Y2VwdGlvbnMpKSB7CgkJCQkJCSR0aGlzLT5hZGRfdG9f
c2V0cygkc2V0X2lkLCAkaSk7CgkJCQkJfQoJCQkJfQoJCQkJaWYoJHRoaXMtPm1vZGU9PSdu
b25lJykgewoJCQkJCWlmKGluX2FycmF5KCRzZXRfaWQsICR0aGlzLT5leGNlcHRpb25zKSkg
ewoJCQkJCQkkdGhpcy0+YWRkX3RvX3NldHMoJHNldF9pZCwgJGkpOwoJCQkJCX0KCQkJCX0K
CQkJCSRpKys7CgkJCX0KCQl9Cgl9CgoJZnVuY3Rpb24gYWRkX3RvX3NldHMoJHNldF9pZCwg
JGkpIHsKCQkkc2V0ID0gYXJyYXkoJ2lkJyA9PiAkc2V0X2lkKTsKCQkkc2V0Wyd0aXRsZSdd
ID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoIi9yc3AvcGhvdG9zZXRzL3Bob3Rv
c2V0WyRpXS90aXRsZS90ZXh0KCkiKSk7CgkJJHNldFsnZGVzY3JpcHRpb24nXSA9IGFycmF5
X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvc2V0cy9waG90b3NldFskaV0v
ZGVzY3JpcHRpb24vdGV4dCgpIikpOwoJCSRzZXRbJ3ByaW1hcnknXSA9IGFycmF5X3NoaWZ0
KCR0aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvc2V0cy9waG90b3NldFskaV0vQHByaW1h
cnkiKSk7CgkJJHNldFsnZmFybSddID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgo
Ii9yc3AvcGhvdG9zZXRzL3Bob3Rvc2V0WyRpXS9AZmFybSIpKTsKCQkkc2V0WydzZWNyZXQn
XSA9IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvc2V0cy9waG90
b3NldFskaV0vQHNlY3JldCIpKTsKCQkkc2V0WydzZXJ2ZXInXSA9IGFycmF5X3NoaWZ0KCR0
aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvc2V0cy9waG90b3NldFskaV0vQHNlcnZlciIp
KTsKCQkkc2V0WydwaG90b3MnXSA9IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCIv
cnNwL3Bob3Rvc2V0cy9waG90b3NldFskaV0vQHBob3RvcyIpKTsKCQlhcnJheV9wdXNoKCR0
aGlzLT5zZXRzLCAkc2V0KTsKCX0KCglmdW5jdGlvbiBzZXRfaW1nKCRwYXJhbXMpIHsKCQkk
aW1nX3VybCA9ICR0aGlzLT5nZXRQaG90b1VybCgkdGhpcy0+c2V0LCAkdGhpcy0+c2V0X3By
ZXZpZXdfc2l6ZSk7CgkJJGltZ191cmwgPSAnPGltZyBzcmM9IicgLiAkaW1nX3VybCAuICci
IGFsdD0iJyAuICR0aGlzLT50aXRsZXNbJHRoaXMtPmldOwoJCShpc3NldCgkcGFyYW1zWyd0
aXRsZSddKSk/ICRpbWdfdXJsIC49ICciIHRpdGxlPSInIC4gJHBhcmFtc1sndGl0bGUnXSAu
ICciIC8+JyA6ICRpbWdfdXJsIC49ICciIC8+JzsKCQlyZXR1cm4gJGltZ191cmw7Cgl9CgoJ
ZnVuY3Rpb24gc2V0X2xpbmsoJHBhcmFtcywgJHRoaW5nKSB7CgkJJHdoYXQgPSAnIGhyZWY9
IicuICR0aGlzLT5tYWtlUmVxdWVzdChhcnJheSgnc2V0JyA9PiAkdGhpcy0+c2V0WydpZCdd
KSkgLiciJzsKCQlpZiAoaXNzZXQoJHBhcmFtc1sndGl0bGUnXSkpICR3aGF0IC49ICcgdGl0
bGU9IicgLiAkcGFyYW1zWyd0aXRsZSddIC4gJyInOwoJCSRodG1sID0gdGFnKCR0aGluZywn
YScsJHdoYXQpOwoJCXJldHVybiAkaHRtbDsKCX0KCglmdW5jdGlvbiBzZXRfdGl0bGUoKSB7
CgkJJGh0bWwgPSAkdGhpcy0+c2V0Wyd0aXRsZSddOwoJCXJldHVybiAkaHRtbDsKCX0KCglm
dW5jdGlvbiBzZXRfbnVtYmVyX29mX3Bob3RvcygpIHsKCQkkaHRtbCA9ICR0aGlzLT5zZXRb
J3Bob3RvcyddOwoJCXJldHVybiAkaHRtbDsKCX0KCglmdW5jdGlvbiBzZXRfZGVzY3JpcHRp
b24oKSB7CgkJJGh0bWwgPSAkdGhpcy0+c2V0WydkZXNjcmlwdGlvbiddOwoJCXJldHVybiAk
aHRtbDsKCX0KCglmdW5jdGlvbiBzZXRfbGlzdCgkcGFyYW1zKSB7CgkJaWYoISR0aGlzLT54
bWwtPmlzVmFsaWQoKSkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCShpc3NldCgkcGFyYW1z
Wyd3cmFwdGFnJ10pID09IHRydWUpPyAkd3JhcHRhZyA9ICRwYXJhbXNbJ3dyYXB0YWcnXSA6
ICR3cmFwdGFnID0gJyc7CgkJKGlzc2V0KCRwYXJhbXNbJ2JyZWFrJ10pID09IHRydWUpPyAk
YnJlYWsgPSAkcGFyYW1zWydicmVhayddIDogJGJyZWFrID0gJ2JyJzsKCQkkdGhpcy0+aSA9
IDA7CgkJZm9yZWFjaCAoJHRoaXMtPnNldHMgYXMgJHRoaXMtPnNldCkgewoJCQkoJF9HRVRb
J3NldCddID09IChmbG9hdCkgJHRoaXMtPnNldFsnaWQnXSk/ICRwYXJhbSA9ICcgY2xhc3M9
ImN1cnJlbnQiJyA6ICcnOwoJCQkoJGJyZWFrICE9ICdicicpPwoJCQkkaHRtbCAuPSB0YWco
JHRoaXMtPnNldF9saW5rKCcnLCAkdGhpcy0+c2V0X3RpdGxlKCkpLCAkYnJlYWssICRwYXJh
bSkgLiAiXG4iOgoJCQkkaHRtbCAuPSAkdGhpcy0+c2V0X2xpbmsoJycsICR0aGlzLT5zZXRf
dGl0bGUoKSkgLic8YnIgLz4nIC4gIlxuIjsKCQkJJHRoaXMtPmkrKzsKCQkJdW5zZXQoJHBh
cmFtKTsKCQl9CgkJcmV0dXJuICgoJHdyYXB0YWcgIT0gJycpID09IHRydWUpPyB0YWcoJGh0
bWwsICR3cmFwdGFnKSA6ICRodG1sOwoJfQoKCWZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CgkJ
aWYoISR0aGlzLT54bWwtPmlzVmFsaWQoKSkgewoJCQlyZXR1cm4gJEdMT0JBTFNbJ3RleHQn
XVsnZXJyb3JfbWVzc2FnZSddOwoJCX0KCQkkdGhpcy0+aSA9IDA7CgkJJHJlc3VsdCA9ICcn
OwoJCWZvcmVhY2ggKCR0aGlzLT5zZXRzIGFzICR0aGlzLT5zZXQpIHsKCQkJJHJlc3VsdCAu
PSBwYXJzZSgkdGhpcy0+Zm9ybSk7CgkJCSR0aGlzLT5pKys7CgkJfQoJCXJldHVybiAkcmVz
dWx0OwoJfQp9CgoKY2xhc3MgVGh1bWJuYWlscyBleHRlbmRzIFZkaF9GbGlja3IgewoJdmFy
ICR4bWwsICRpZCwgJG93bmVyLCAkcHJpbWFyeSwgJHNlY3JldCwgJG51bWJlcl9vZl9waG90
b3MsICR0aXRsZSwgJGRlc2NyaXB0aW9uLCAkc2V0LCAkcGhvdG8sICRsYXRlc3Q7Cgl2YXIg
JHRodW1ibmFpbF9zaXplLCAkaW1nX3NpemUsICRvcGVuLCAkdGFnX2FuZCwgJGxpbmssICR1
c2VfYXJ0X2lkX2FzX3RhZzsKCXZhciAkcGFnZSwgJHRodW1ic19wZXJfcGFnZSwgJHN0YXJ0
LCAkZW5kLCAkbGFzdHBhZ2UsICRwcmV2aW91c19wYWdlLCAkbmV4dF9wYWdlOwoJdmFyICRw
aG90b3MgPSBhcnJheSgpLCAkdGFncyA9IGFycmF5KCk7CgoJZnVuY3Rpb24gVGh1bWJuYWls
cygkcGFyYW1zKSB7CgkJJHRoaXMtPlZkaF9GbGlja3IoJHBhcmFtcyk7CgkJJHRoaXMtPnBh
cmFtcyA9ICRwYXJhbXM7CgkJKGlzc2V0KCRwYXJhbXNbJ3RodW1ibmFpbF9zaXplJ10pKT8K
CQkkdGhpcy0+dGh1bWJuYWlsX3NpemUgPSAkcGFyYW1zWyd0aHVtYm5haWxfc2l6ZSddOgoJ
CSR0aGlzLT50aHVtYm5haWxfc2l6ZSA9ICdzJzsKCQkoaXNzZXQoJHBhcmFtc1snaW1nX3Np
emUnXSkpPwoJCSR0aGlzLT5pbWdfc2l6ZSA9ICRwYXJhbXNbJ2ltZ19zaXplJ106CgkJJHRo
aXMtPmltZ19zaXplID0gJ24nOwoJCShpc3NldCgkcGFyYW1zWydvcGVuJ10pKT8KCQkkdGhp
cy0+b3BlbiA9ICRwYXJhbXNbJ29wZW4nXToKCQkkdGhpcy0+b3BlbiA9ICdzZWxmJzsKCQko
aXNzZXQoJHBhcmFtc1snc2V0J10pKT8KCQkkdGhpcy0+c2V0ID0gJHBhcmFtc1snc2V0J106
CgkJJHRoaXMtPnNldCA9ICRfR0VUWydzZXQnXTsKCQkoaXNzZXQoJF9HRVRbJ3RhZ3MnXSkp
PwoJCUAkdGhpcy0+dGFncyA9ICRfR0VUWyd0YWdzJ106CgkJQCR0aGlzLT50YWdzID0gJHBh
cmFtc1sndGFncyddOwoJCWlmKCFlbXB0eSgkdGhpcy0+dGFncykpIHVuc2V0KCR0aGlzLT5z
ZXQpOwoJCShpc3NldCgkX0dFVFsncGFnZSddKSk/CgkJJHRoaXMtPnBhZ2UgPSAkX0dFVFsn
cGFnZSddOgoJCSR0aGlzLT5wYWdlID0gMTsKCQlpZiAoaXNzZXQoJHBhcmFtc1snbGF0ZXN0
J10pKSAkdGhpcy0+bGF0ZXN0ID0gJHBhcmFtc1snbGF0ZXN0J107CgkJKGlzc2V0KCRwYXJh
bXNbJ2xpbmt0aHVtYnMnXSkpPwoJCSR0aGlzLT5saW5rdGh1bWJzID0gJHBhcmFtc1snbGlu
a3RodW1icyddOgoJCSR0aGlzLT5saW5rdGh1bWJzID0gMTsKCQkoaXNzZXQoJHBhcmFtc1sn
dXNlX2FydF9pZF9hc190YWcnXSkpPwoJCSR0aGlzLT51c2VfYXJ0X2lkX2FzX3RhZyA9ICRw
YXJhbXNbJ3VzZV9hcnRfaWRfYXNfdGFnJ106CgkJJHRoaXMtPnVzZV9hcnRfaWRfYXNfdGFn
ID0gMDsKCQlpZiAoaXNzZXQoJHBhcmFtc1sndGFnX2FuZCddKSkgJHRoaXMtPnRhZ19hbmQg
PSAxOwoJCWlmIChpc3NldCgkcGFyYW1zWyd0aHVtYm5haWxzX2Zvcm0nXSkpICR0aGlzLT5m
b3JtID0gZmV0Y2goJ0Zvcm0nLCd0eHBfZm9ybScsIm5hbWUiLCRwYXJhbXNbJ3RodW1ibmFp
bHNfZm9ybSddKTsKCQllbHNlIHsKCQkJJHRoaXMtPmZvcm0gPSAnCgkJCTxoMz48dHhwOnZk
aF9mbGlja3JfdGh1bWJuYWlsc190aXRsZSAvPiwgPHR4cDp2ZGhfZmxpY2tyX3RodW1ibmFp
bHNfbnVtYmVyX29mX3Bob3RvcyAvPiBQaG90b3M8L2gzPgoJCQk8cCBjbGFzcz0iZmxpY2ty
X3NsaWRlc2hvdyI+CgkJCTx0eHA6dmRoX2ZsaWNrcl90aHVtYm5haWxzX3NsaWRlc2hvdz4m
cmFxdW87IFNob3cgYXMgc2xpZGVzaG93IGluIG5ldyB3aW5kb3cuPC90eHA6dmRoX2ZsaWNr
cl90aHVtYm5haWxzX3NsaWRlc2hvdz4KCQkJPC9wPgoJCQk8dHhwOnZkaF9mbGlja3JfdGh1
bWJuYWlsc19pZl9kZXNjcmlwdGlvbj4KCQkJPHAgY2xhc3M9ImZsaWNrcl90aHVtYm5haWxz
X2Rlc2NyaXB0aW9uIj4KCQkJPHR4cDp2ZGhfZmxpY2tyX3RodW1ibmFpbHNfZGVzY3JpcHRp
b24gLz4KCQkJPC9wPgoJCQk8L3R4cDp2ZGhfZmxpY2tyX3RodW1ibmFpbHNfaWZfZGVzY3Jp
cHRpb24+CgkJCTxkaXYgY2xhc3M9ImZsaWNrcnNldCI+CgkJCTx0eHA6dmRoX2ZsaWNrcl90
aHVtYm5haWxzX2xpc3QgLz4KCQkJPC9kaXY+CgkJCTx0eHA6dmRoX2ZsaWNrcl90aHVtYm5h
aWxzX2lmX211bHRpcGxlX3BhZ2VzPgoJCQk8aDMgY2xhc3M9InBhZ2VzX25hdiI+cGFnZXMg
bmF2aWdhdGlvbjwvaDM+CgkJCTxwPgoJCQl0aHVtYnMgcGVyIHBhZ2U6IDx0eHA6dmRoX2Zs
aWNrcl90aHVtYm5haWxzX3Blcl9wYWdlIC8+PGJyIC8+CgkJCVNob3dpbmcgcGFnZSA8dHhw
OnZkaF9mbGlja3JfdGh1bWJuYWlsc19jdXJyZW50X3BhZ2UgLz4gb2YgPHR4cDp2ZGhfZmxp
Y2tyX3RodW1ibmFpbHNfdG90YWxfcGFnZXMgLz4uPGJyIC8+CgkJCVNob3dpbmcgdGh1bWIg
PHR4cDp2ZGhfZmxpY2tyX3RodW1ibmFpbHNfcGFnZXNfc3RhcnR0aHVtYiAvPiB0byA8dHhw
OnZkaF9mbGlja3JfdGh1bWJuYWlsc19wYWdlc19lbmR0aHVtYiAvPi48YnIgLz4KCQkJPHR4
cDp2ZGhfZmxpY2tyX3RodW1ibmFpbHNfcGFnZXNfZmlyc3Q+JmxhcXVvOyBmaXJzdDwvdHhw
OnZkaF9mbGlja3JfdGh1bWJuYWlsc19wYWdlc19maXJzdD4gfAoJCQk8dHhwOnZkaF9mbGlj
a3JfdGh1bWJuYWlsc19wYWdlc19wcmV2aW91cz4mbHQ7IHByZXZpb3VzPC90eHA6dmRoX2Zs
aWNrcl90aHVtYm5haWxzX3BhZ2VzX3ByZXZpb3VzPiB8CgkJCTx0eHA6dmRoX2ZsaWNrcl90
aHVtYm5haWxzX3BhZ2VzX25leHQ+bmV4dCAmZ3Q7PC90eHA6dmRoX2ZsaWNrcl90aHVtYm5h
aWxzX3BhZ2VzX25leHQ+IHwKCQkJPHR4cDp2ZGhfZmxpY2tyX3RodW1ibmFpbHNfcGFnZXNf
bGFzdD5sYXN0ICZyYXF1bzs8L3R4cDp2ZGhfZmxpY2tyX3RodW1ibmFpbHNfcGFnZXNfbGFz
dD4KCQkJPC9wPgoJCQlHbyB0byBwYWdlIG51bWJlcjoKCQkJPHR4cDp2ZGhfZmxpY2tyX3Ro
dW1ibmFpbHNfcGFnZXNfbGlzdCB3cmFwdGFnPSJ1bCIgYnJlYWs9ImxpIiBjbGFzcyA9InRo
dW1ic19wYWdlcyIgLz4KCQkJPC90eHA6dmRoX2ZsaWNrcl90aHVtYm5haWxzX2lmX211bHRp
cGxlX3BhZ2VzPgoJCQk8ZGl2IHN0eWxlPSJjbGVhcjpib3RoOyI+PC9kaXY+JzsKCQl9CgkJ
JHRoaXMtPmdldFBob3RvcygpOwoJCSR0aGlzLT50aHVtYnNfcGVyX3BhZ2UgPSAwOwoJCWlm
IChpc3NldCgkcGFyYW1zWyd0aHVtYnNfcGVyX3BhZ2UnXSkpIHsKCQkJJHRoaXMtPnRodW1i
c19wZXJfcGFnZSA9ICRwYXJhbXNbJ3RodW1ic19wZXJfcGFnZSddOwoJCQkkdGhpcy0+bGFz
dHBhZ2UgPSBjZWlsKCR0aGlzLT5udW1iZXJfb2ZfcGhvdG9zIC8gJHRoaXMtPnRodW1ic19w
ZXJfcGFnZSk7CgkJCWlmICgkdGhpcy0+cGFnZS0xID49IDEpIHsKCQkJCSR0aGlzLT5wcmV2
aW91c19wYWdlID0gJHRoaXMtPnBhZ2UgLSAxOwoJCQl9CgkJCWVsc2UgewoJCQkJJHRoaXMt
PnByZXZpb3VzX3BhZ2UgPSAkdGhpcy0+bGFzdHBhZ2U7CgkJCX0KCQkJaWYgKCR0aGlzLT5w
YWdlKzEgPD0gJHRoaXMtPmxhc3RwYWdlKSB7CgkJCQkkdGhpcy0+bmV4dF9wYWdlID0gJHRo
aXMtPnBhZ2UgKyAxOwoJCQl9CgkJCWVsc2UgewoJCQkJJHRoaXMtPm5leHRfcGFnZSA9ICAx
OwoJCQl9CgkJfQoJfQoKCWZ1bmN0aW9uIGdldFBob3RvcygpIHsKCQlpZiAoJHRoaXMtPnVz
ZV9hcnRfaWRfYXNfdGFnID09IDEpIHsKCQkJZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCQkJaWYo
aXNzZXQoJHRoaXMtPnRhZ3MpIGFuZCAoJHRoaXMtPnRhZ3MgIT0gJycpKSB7CgkJCQkkdGhp
cy0+dGFncyAuPSAnLCc7CgkJCX0KCQkJJHRoaXMtPnRhZ3MgLj0gJ2FydGljbGUnLiR0aGlz
YXJ0aWNsZVsndGhpc2lkJ107CgkJfQoJCWlmIChpc3NldCgkdGhpcy0+dGFncykpIHsKCQkJ
JHRoaXMtPnRpdGxlID0gJHRoaXMtPnRhZ3M7CgkJCSRtZXRob2QgPSAnZmxpY2tyLnBob3Rv
cy5zZWFyY2gnIC4gJHRoaXMtPnVzZXJkYXRhIC4gJyZ0YWdzPScgLiAkdGhpcy0+dGFncyAu
ICcmcGVyX3BhZ2U9NTAwJmV4dHJhcz1vcmlnaW5hbF9mb3JtYXQnOwoJCQlpZiAoaXNzZXQo
JHRoaXMtPnRhZ19hbmQpKSB7CgkJCQkkbWV0aG9kIC49ICcmdGFnX21vZGU9YWxsJzsKCQkJ
fQoJCQkkdGhpcy0+eG1sID0gbmV3IEZsaWNrcigkbWV0aG9kKTsKCQkJaWYoJHRoaXMtPnht
bC0+aXNWYWxpZCgpKSB7CgkJCQlmb3JlYWNoKCR0aGlzLT54bWwtPnhwYXRoKCcvcnNwL3Bo
b3Rvcy9waG90by9AaWQnKSBhcyAkcGhvdG9faWQpIHsKCQkJCQkkcGhvdG8gPSBhcnJheSgn
aWQnID0+ICRwaG90b19pZCk7CgkJCQkJJHBob3RvWyd0aXRsZSddID0gYXJyYXlfc2hpZnQo
JHRoaXMtPnhtbC0+eHBhdGgoIi9yc3AvcGhvdG9zL3Bob3RvW0BpZD0iLiRwaG90b19pZC4i
XS9AdGl0bGUiKSk7CgkJCQkJJHBob3RvWydzZWNyZXQnXSA9IGFycmF5X3NoaWZ0KCR0aGlz
LT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvcy9waG90b1tAaWQ9Ii4kcGhvdG9faWQuIl0vQHNl
Y3JldCIpKTsKCQkJCQkkcGhvdG9bJ29yaWdpbmFsX3NlY3JldCddID0gYXJyYXlfc2hpZnQo
JHRoaXMtPnhtbC0+eHBhdGgoIi9yc3AvcGhvdG9zL3Bob3RvW0BpZD0iLiRwaG90b19pZC4i
XS9Ab3JpZ2luYWxzZWNyZXQiKSk7CgkJCQkJJHBob3RvWydvcmlnaW5hbF9mb3JtYXQnXSA9
IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvcy9waG90b1tAaWQ9
Ii4kcGhvdG9faWQuIl0vQG9yaWdpbmFsZm9ybWF0IikpOwoJCQkJCSRwaG90b1snc2VydmVy
J10gPSBhcnJheV9zaGlmdCgkdGhpcy0+eG1sLT54cGF0aCgiL3JzcC9waG90b3MvcGhvdG9b
QGlkPSIuJHBob3RvX2lkLiJdL0BzZXJ2ZXIiKSk7CgkJCQkJJHBob3RvWydmYXJtJ10gPSBh
cnJheV9zaGlmdCgkdGhpcy0+eG1sLT54cGF0aCgiL3JzcC9waG90b3MvcGhvdG9bQGlkPSIu
JHBob3RvX2lkLiJdL0BmYXJtIikpOwoJCQkJCWFycmF5X3B1c2goJHRoaXMtPnBob3Rvcywg
JHBob3RvKTsKCQkJCX0KCQkJCSR0aGlzLT5udW1iZXJfb2ZfcGhvdG9zID0gKHN0cmluZykg
YXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoJy9yc3AvcGhvdG9zL0B0b3RhbCcpKTsK
CQkJCWlmIChpc3NldCgkdGhpcy0+cGFyYW1zWydyYW5kb20nXSkpICR0aGlzLT5yYW5kb21p
emUoJHRoaXMtPnBhcmFtc1sncmFuZG9tJ10pOwoJCQl9CgkJfQoJCWlmIChpc3NldCgkdGhp
cy0+bGF0ZXN0KSkgewoJCQkkdGhpcy0+dGl0bGUgPSAkR0xPQkFMU1sndGV4dCddWydsYXRl
c3QnXTsKCQkJJG1ldGhvZCA9ICdmbGlja3IucGhvdG9zLnNlYXJjaCcgLiAkdGhpcy0+dXNl
cmRhdGE7CgkJCWlmICgkdGhpcy0+dGh1bWJzX3Blcl9wYWdlID09IDAgb3IgJHRoaXMtPmxh
dGVzdCA8PSAkdGhpcy0+dGh1bWJzX3Blcl9wYWdlKSAkbWV0aG9kIC49ICcmcGVyX3BhZ2U9
JyAuICR0aGlzLT5sYXRlc3Q7CgkJCWVsc2UgewoJCQkJJG1ldGhvZCAuPSAnJnBlcl9wYWdl
PScgLiAkdGhpcy0+dGh1bWJzX3Blcl9wYWdlOwoJCQl9CgkJCSRtZXRob2QgLj0gIiZleHRy
YXM9b3JpZ2luYWxfZm9ybWF0IjsKCQkJJHRoaXMtPnhtbCA9IG5ldyBGbGlja3IoJG1ldGhv
ZCk7CgkJCWlmKCR0aGlzLT54bWwtPmlzVmFsaWQoKSkgewoJCQkJZm9yZWFjaCgkdGhpcy0+
eG1sLT54cGF0aCgnL3JzcC9waG90b3MvcGhvdG8vQGlkJykgYXMgJHBob3RvX2lkKSB7CgkJ
CQkJJHBob3RvID0gYXJyYXkoJ2lkJyA9PiAkcGhvdG9faWQpOwoJCQkJCSRwaG90b1sndGl0
bGUnXSA9IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvcy9waG90
b1tAaWQ9Ii4kcGhvdG9faWQuIl0vQHRpdGxlIikpOwoJCQkJCSRwaG90b1snc2VjcmV0J10g
PSBhcnJheV9zaGlmdCgkdGhpcy0+eG1sLT54cGF0aCgiL3JzcC9waG90b3MvcGhvdG9bQGlk
PSIuJHBob3RvX2lkLiJdL0BzZWNyZXQiKSk7CgkJCQkJJHBob3RvWydvcmlnaW5hbF9zZWNy
ZXQnXSA9IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvcy9waG90
b1tAaWQ9Ii4kcGhvdG9faWQuIl0vQG9yaWdpbmFsc2VjcmV0IikpOwoJCQkJCSRwaG90b1sn
b3JpZ2luYWxfZm9ybWF0J10gPSBhcnJheV9zaGlmdCgkdGhpcy0+eG1sLT54cGF0aCgiL3Jz
cC9waG90b3MvcGhvdG9bQGlkPSIuJHBob3RvX2lkLiJdL0BvcmlnaW5hbGZvcm1hdCIpKTsK
CQkJCQkkcGhvdG9bJ3NlcnZlciddID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgo
Ii9yc3AvcGhvdG9zL3Bob3RvW0BpZD0iLiRwaG90b19pZC4iXS9Ac2VydmVyIikpOwoJCQkJ
CSRwaG90b1snZmFybSddID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoIi9yc3Av
cGhvdG9zL3Bob3RvW0BpZD0iLiRwaG90b19pZC4iXS9AZmFybSIpKTsKCQkJCQlhcnJheV9w
dXNoKCR0aGlzLT5waG90b3MsICRwaG90byk7CgkJCQl9CgkJCQkkdGhpcy0+bnVtYmVyX29m
X3Bob3RvcyA9IChzdHJpbmcpICR0aGlzLT5sYXRlc3Q7CgkJCQlpZiAoaXNzZXQoJHRoaXMt
PnBhcmFtc1sncmFuZG9tJ10pKSAkdGhpcy0+cmFuZG9taXplKCR0aGlzLT5wYXJhbXNbJ3Jh
bmRvbSddKTsKCQkJfQoJCX0KCQlpZiAoaXNzZXQoJHRoaXMtPnNldCkpIHsKCQkJJG1ldGhv
ZCA9ICdmbGlja3IucGhvdG9zZXRzLmdldFBob3RvcycgLiAkdGhpcy0+dXNlcmRhdGEgLiAn
JnBob3Rvc2V0X2lkPScgLiAkdGhpcy0+c2V0IC4gIiZleHRyYXM9b3JpZ2luYWxfZm9ybWF0
IjsKCQkJJHRoaXMtPnhtbCA9IG5ldyBGbGlja3IoJG1ldGhvZCk7CgkJCWlmKCR0aGlzLT54
bWwtPmlzVmFsaWQoKSkgewoJCQkJZm9yZWFjaCgkdGhpcy0+eG1sLT54cGF0aCgnL3JzcC9w
aG90b3NldC9waG90by9AaWQnKSBhcyAkcGhvdG9faWQpIHsKCQkJCQkkcGhvdG8gPSBhcnJh
eSgnaWQnID0+ICRwaG90b19pZCk7CgkJCQkJJHBob3RvWyd0aXRsZSddID0gYXJyYXlfc2hp
ZnQoJHRoaXMtPnhtbC0+eHBhdGgoIi9yc3AvcGhvdG9zZXQvcGhvdG9bQGlkPSIuJHBob3Rv
X2lkLiJdL0B0aXRsZSIpKTsKCQkJCQkkcGhvdG9bJ3NlY3JldCddID0gYXJyYXlfc2hpZnQo
JHRoaXMtPnhtbC0+eHBhdGgoIi9yc3AvcGhvdG9zZXQvcGhvdG9bQGlkPSIuJHBob3RvX2lk
LiJdL0BzZWNyZXQiKSk7CgkJCQkJJHBob3RvWydvcmlnaW5hbF9zZWNyZXQnXSA9IGFycmF5
X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvc2V0L3Bob3RvW0BpZD0iLiRw
aG90b19pZC4iXS9Ab3JpZ2luYWxzZWNyZXQiKSk7CgkJCQkJJHBob3RvWydvcmlnaW5hbF9m
b3JtYXQnXSA9IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bob3Rvc2V0
L3Bob3RvW0BpZD0iLiRwaG90b19pZC4iXS9Ab3JpZ2luYWxmb3JtYXQiKSk7CgkJCQkJJHBo
b3RvWydzZXJ2ZXInXSA9IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCIvcnNwL3Bo
b3Rvc2V0L3Bob3RvW0BpZD0iLiRwaG90b19pZC4iXS9Ac2VydmVyIikpOwoJCQkJCSRwaG90
b1snZmFybSddID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoIi9yc3AvcGhvdG9z
ZXQvcGhvdG9bQGlkPSIuJHBob3RvX2lkLiJdL0BmYXJtIikpOwoJCQkJCWFycmF5X3B1c2go
JHRoaXMtPnBob3RvcywgJHBob3RvKTsKCQkJCX0KCQkJCSR0aGlzLT5udW1iZXJfb2ZfcGhv
dG9zID0gKHN0cmluZykgc2l6ZW9mKCR0aGlzLT5waG90b3MpOwoJCQkJaWYgKGlzc2V0KCR0
aGlzLT5wYXJhbXNbJ3JhbmRvbSddKSkgJHRoaXMtPnJhbmRvbWl6ZSgkdGhpcy0+cGFyYW1z
WydyYW5kb20nXSk7CgkJCX0KCQl9Cgl9CgoJZnVuY3Rpb24gcmFuZG9taXplKCRyYW5kc2l6
ZSkgewoJCWlmICgkcmFuZHNpemUgPCAkdGhpcy0+bnVtYmVyX29mX3Bob3RvcykgewoJCQlz
aHVmZmxlKCR0aGlzLT5waG90b3MpOwoJCQkkdGhpcy0+cGhvdG9zID0gYXJyYXlfc2xpY2Uo
JHRoaXMtPnBob3RvcywgMCwgJHJhbmRzaXplKTsKCQkJJHRoaXMtPm51bWJlcl9vZl9waG90
b3MgPSAkcmFuZHNpemU7CgkJfQoJfQoKCWZ1bmN0aW9uIGdldEluZm8oKSB7CgkJJG1ldGhv
ZCA9ICdmbGlja3IucGhvdG9zZXRzLmdldEluZm8nIC4gJHRoaXMtPnVzZXJkYXRhIC4gJyZw
aG90b3NldF9pZD0nIC4gJHRoaXMtPnNldDsKCQkkdGhpcy0+eG1sID0gbmV3IEZsaWNrcigk
bWV0aG9kKTsKCQlpZigkdGhpcy0+eG1sLT5pc1ZhbGlkKCkpIHsKCQkJJHRoaXMtPmlkID0g
YXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoJy9yc3AvcGhvdG9zZXQvQGlkJykpOwoJ
CQkkdGhpcy0+cHJpbWFyeSA9IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCcvcnNw
L3Bob3Rvc2V0L0BwcmltYXJ5JykpOwoJCQkkdGhpcy0+c2VjcmV0ID0gYXJyYXlfc2hpZnQo
JHRoaXMtPnhtbC0+eHBhdGgoJy9yc3AvcGhvdG9zZXQvQHNlY3JldCcpKTsKCQkJJHRoaXMt
PnRpdGxlID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoJy9yc3AvcGhvdG9zZXQv
dGl0bGUvdGV4dCgpJykpOwoJCQkkdGhpcy0+ZGVzY3JpcHRpb24gPSBhcnJheV9zaGlmdCgk
dGhpcy0+eG1sLT54cGF0aCgnL3JzcC9waG90b3NldC9kZXNjcmlwdGlvbi90ZXh0KCknKSk7
CgkJCWlmIChlbXB0eSgkdGhpcy0+ZGVzY3JpcHRpb24pKSAkdGhpcy0+ZGVzY3JpcHRpb24g
PSAnJm5ic3A7JzsKCQl9Cgl9CgoJZnVuY3Rpb24gdGh1bWJuYWlsc190aXRsZSgpIHsKCQlp
ZiAoaXNzZXQoJHRoaXMtPnRpdGxlKSA9PSBmYWxzZSkgJHRoaXMtPmdldEluZm8oKTsKCQly
ZXR1cm4gJHRoaXMtPnRpdGxlOwoJfQoKCWZ1bmN0aW9uIHRodW1ibmFpbHNfZGVzY3JpcHRp
b24oKSB7CgkJaWYgKChpc3NldCgkdGhpcy0+ZGVzY3JpcHRpb24pID09IGZhbHNlKSBhbmQg
aXNzZXQoJHRoaXMtPnNldCkpIHsKCQkJJHRoaXMtPmdldEluZm8oKTsKCQl9CgkJaWYgKCR0
aGlzLT5kZXNjcmlwdGlvbiAhPSAnJm5ic3A7JyBhbmQgIWVtcHR5KCR0aGlzLT5kZXNjcmlw
dGlvbikpIHJldHVybiAkdGhpcy0+ZGVzY3JpcHRpb247CgkJcmV0dXJuICcnOwoJfQoKCWZ1
bmN0aW9uIHRodW1ibmFpbHNfaWZfZGVzY3JpcHRpb24gKCR0aGluZykgewoJCWlmICgoaXNz
ZXQoJHRoaXMtPmRlc2NyaXB0aW9uKSA9PSBmYWxzZSkgYW5kIGlzc2V0KCR0aGlzLT5zZXQp
KSB7CgkJCSR0aGlzLT5nZXRJbmZvKCk7CgkJfQoJCWlmICgkdGhpcy0+ZGVzY3JpcHRpb24g
IT0gJyZuYnNwOycgYW5kICFlbXB0eSgkdGhpcy0+ZGVzY3JpcHRpb24pKSAkcmVzdWx0ID0g
cGFyc2UoJHRoaW5nKTsKCQlyZXR1cm4gJHJlc3VsdDsKCX0KCglmdW5jdGlvbiB0aHVtYm5h
aWxzX3NsaWRlc2hvdygkdGhpbmcpIHsKCQlpZihpc3NldCgkdGhpcy0+dGFncykpIHsKCQkJ
JGh0bWwgPSAnPGEgaHJlZj0iaHR0cDovL3d3dy5mbGlja3IuY29tL3NsaWRlU2hvdy9pbmRl
eC5nbmU/bnNpZD0nLnVybGVuY29kZSgkdGhpcy0+bnNpZCkuJyZhbXA7dXNlcl9pZD0nLnVy
bGVuY29kZSgkdGhpcy0+bnNpZCk7CgkJCWlmKGlzc2V0KCR0aGlzLT50YWdfYW5kKSkgewoJ
CQkJJGh0bWwgLj0gJyZhbXA7dGFnX21vZGU9YWxsJmFtcDt0YWdzPScuIHVybGVuY29kZSgk
dGhpcy0+dGFncyk7CgkJCX0KCQkJZWxzZSB7CgkJCQkkaHRtbCAuPSAnJmFtcDt0YWdfbW9k
ZT1hbnkmYW1wO3RhZ3M9JyAuIHVybGVuY29kZSgkdGhpcy0+dGFncyk7CgkJCX0KCQkJJGh0
bWwgLj0gJyIgIG9uY2xpY2s9IndpbmRvdy5vcGVuKHRoaXMuaHJlZiwgXCdzbGlkZVNob3dX
aW5cJywgXCd3aWR0aD01MDAsaGVpZ2h0PTUwMCx0b3A9MTUwLGxlZnQ9NzAsc2Nyb2xsYmFy
cz1ubywgc3RhdHVzPW5vLCByZXNpemFibGU9bm9cJyk7ICc7CgkJCSRodG1sIC49ICdyZXR1
cm4gZmFsc2U7Ij4nOwoJCX0KCQlpZihpc3NldCgkdGhpcy0+c2V0KSkgewoJCQkkaHRtbCA9
ICc8YSBocmVmPSJodHRwOi8vd3d3LmZsaWNrci5jb20vc2xpZGVTaG93L2luZGV4LmduZT9u
c2lkPScudXJsZW5jb2RlKCR0aGlzLT5uc2lkKS4nJmFtcDtzZXRfaWQ9Jy4kdGhpcy0+c2V0
OwoJCQkkaHRtbCAuPSAnIiAgb25jbGljaz0id2luZG93Lm9wZW4odGhpcy5ocmVmLCBcJ3Ns
aWRlU2hvd1dpblwnLCBcJ3dpZHRoPTUwMCxoZWlnaHQ9NTAwLHRvcD0xNTAsbGVmdD03MCxz
Y3JvbGxiYXJzPW5vLCBzdGF0dXM9bm8sIHJlc2l6YWJsZT1ub1wnKTsgJzsKCQkJJGh0bWwg
Lj0gJ3JldHVybiBmYWxzZTsiPic7CgkJfQoJCWlmKGlzc2V0KCR0aGlzLT5sYXRlc3QpKSB7
CgkJCSRodG1sID0gJzxhIGhyZWY9Imh0dHA6Ly93d3cuZmxpY2tyLmNvbS9zbGlkZVNob3cv
aW5kZXguZ25lP25zaWQ9Jy51cmxlbmNvZGUoJHRoaXMtPm5zaWQpLicmYW1wO3VzZXJfaWQ9
Jy51cmxlbmNvZGUoJHRoaXMtPm5zaWQpLicmYW1wO21heFRodW1icz0nLiR0aGlzLT5sYXRl
c3Q7CgkJCSRodG1sIC49ICciICBvbmNsaWNrPSJ3aW5kb3cub3Blbih0aGlzLmhyZWYsIFwn
c2xpZGVTaG93V2luXCcsIFwnd2lkdGg9NTAwLGhlaWdodD01MDAsdG9wPTE1MCxsZWZ0PTcw
LHNjcm9sbGJhcnM9bm8sIHN0YXR1cz1ubywgcmVzaXphYmxlPW5vXCcpOyAnOwoJCQkkaHRt
bCAuPSAncmV0dXJuIGZhbHNlOyI+JzsKCQl9CgkJJGh0bWwgLj0gJHRoaW5nLic8L2E+JzsK
CQlyZXR1cm4gJGh0bWw7Cgl9CgoJZnVuY3Rpb24gdGh1bWJuYWlsc19pbWcoKSB7CgkJJGlt
Z191cmwgPSAkdGhpcy0+Z2V0UGhvdG9VcmwoJHRoaXMtPnBob3RvLCAkdGhpcy0+dGh1bWJu
YWlsX3NpemUpOwoJCSRpbWdfdXJsID0gJzxpbWcgc3JjPSInIC4gJGltZ191cmwgLiAnIiBh
bHQ9IicgLiAkdGhpcy0+cGhvdG9bJ3RpdGxlJ10gLiAnIiAvPic7CgkJcmV0dXJuICRpbWdf
dXJsOwoJfQoKCWZ1bmN0aW9uIHRodW1ibmFpbHNfaW1nX3RpdGxlKCkgewoJCXJldHVybiAk
dGhpcy0+cGhvdG9bJ3RpdGxlJ107Cgl9CgoJZnVuY3Rpb24gdGh1bWJuYWlsc19saW5rKCRp
bWdfdXJsLCAkdGl0bGUgPSIiKSB7CgkJaWYoJHRoaXMtPm9wZW4gPT0gJ3NlbGYnKSB7CgkJ
CWlmIChpc3NldCgkdGhpcy0+c2V0KSkgewoJCQkJJHBhcmFtZXRlcnNbJ3NldCddID0gJHRo
aXMtPnNldDsKCQkJfQoJCQkkcGFyYW1ldGVyc1snaW1nJ10gPSAkdGhpcy0+cGhvdG9bJ2lk
J107CgkJCSRodG1sID0gdGFnKCRpbWdfdXJsLCdhJywnIGhyZWY9IicuICR0aGlzLT5tYWtl
UmVxdWVzdCgkcGFyYW1ldGVycykgLiciJykuIlxuIjsKCQl9CgkJaWYoJHRoaXMtPm9wZW4g
PT0gJ2ZsaWNrcicpIHsKCQkJJGh0bWwgPSAnPGEgaHJlZj0iaHR0cDovL3d3dy5mbGlja3Iu
Y29tL3Bob3Rvcy8nIC4gdXJsZW5jb2RlKCR0aGlzLT5uc2lkKSAuICcvJyAuICR0aGlzLT5w
aG90b1snaWQnXSAuICcvIj4nIC4gIlxuIjsKCQkJJGh0bWwgLj0gJGltZ191cmw7CgkJCSRo
dG1sIC49ICc8L2E+JyAuICJcbiI7CgkJfQoJCWlmKCR0aGlzLT5vcGVuID09ICd3aW5kb3cn
KSB7CgkJCSRodG1sID0gJzxhIGhyZWY9Iic7CgkJCSRodG1sIC49ICR0aGlzLT5nZXRQaG90
b1VybCgkdGhpcy0+cGhvdG8sICR0aGlzLT5pbWdfc2l6ZSk7CgkJCSRodG1sIC49ICciIG9u
Y2xpY2s9IndpbmRvdy5vcGVuKHRoaXMuaHJlZiwgXCdwb3B1cHdpbmRvd1wnLCBcJ3Jlc2l6
YWJsZVwnKTsgcmV0dXJuIGZhbHNlOyI+JzsKCQkJJGh0bWwgLj0gJGltZ191cmw7CgkJCSRo
dG1sIC49ICc8L2E+JzsKCQl9CgkJaWYoJHRoaXMtPm9wZW4gPT0gJ2xpZ2h0Ym94JykgewoJ
CQkkaHRtbCA9ICc8YSBocmVmPSInOwoJCQkkaHRtbCAuPSAkdGhpcy0+Z2V0UGhvdG9Vcmwo
JHRoaXMtPnBob3RvLCAkdGhpcy0+aW1nX3NpemUpOwoJCQkkc2V0ID0gJHRoaXMtPnRodW1i
bmFpbHNfdGl0bGUoKTsKCQkJJHNldCA9IHRyaW0oJHNldCk7CgkJCSRodG1sIC49ICciIHJl
bD0ibGlnaHRib3hbJy4kc2V0LiddIic7CgkJCSRodG1sIC49ICcgdGl0bGU9IicuJHRpdGxl
LiciPic7CgkJCSRodG1sIC49ICRpbWdfdXJsOwoJCQkkaHRtbCAuPSAnPC9hPic7CgkJfQoJ
CXJldHVybiAkaHRtbDsKCX0KCglmdW5jdGlvbiB0aHVtYm5haWxzX2xpc3QoJHBhcmFtcykg
ewoJCWlmKCEkdGhpcy0+eG1sLT5pc1ZhbGlkKCkpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0K
CQkoaXNzZXQoJHBhcmFtc1snbGlzdG1vZGUnXSkpPwoJCSR0aGlzLT5saXN0bW9kZSA9ICRw
YXJhbXNbJ2xpc3Rtb2RlJ106CgkJJHRoaXMtPmxpc3Rtb2RlID0gJ2ltZyc7CgkJKGlzc2V0
KCRwYXJhbXNbJ3dyYXB0YWcnXSkgPT0gdHJ1ZSk/ICR3cmFwdGFnID0gJHBhcmFtc1snd3Jh
cHRhZyddIDogJHdyYXB0YWcgPSAnJzsKCQkoaXNzZXQoJHBhcmFtc1snYnJlYWsnXSkgPT0g
dHJ1ZSk/ICRicmVhayA9ICRwYXJhbXNbJ2JyZWFrJ10gOiAkYnJlYWsgPSAnJzsKCQlpZiAo
JHRoaXMtPnRodW1ic19wZXJfcGFnZSA9PSAwKSB7CgkJCSR0aGlzLT5zdGFydCA9IDE7CgkJ
CSR0aGlzLT5lbmQgPSBzaXplb2YoJHRoaXMtPnBob3Rvcyk7CgkJfQoJCWVsc2UgewoJCQkk
dGhpcy0+c3RhcnQgPSAoZmxvYXQpICgkdGhpcy0+dGh1bWJzX3Blcl9wYWdlICogKCR0aGlz
LT5wYWdlIC0gMSkpICsgMTsKCQkJJHRoaXMtPmVuZCA9IG1pbigkdGhpcy0+dGh1bWJzX3Bl
cl9wYWdlICogJHRoaXMtPnBhZ2UsIHNpemVvZigkdGhpcy0+cGhvdG9zKSk7CgkJfQoJCSRo
dG1sID0gJyc7CgkJZm9yICgkdGhpcy0+aSA9ICR0aGlzLT5zdGFydCAtIDE7ICR0aGlzLT5p
IDw9ICR0aGlzLT5lbmQgLSAxOyAkdGhpcy0+aSsrKSB7CgkJCSR0aGlzLT5waG90byA9ICR0
aGlzLT5waG90b3NbJHRoaXMtPmldOwoJCQkoQCRfR0VUWydpbWcnXSA9PSAoZmxvYXQpICR0
aGlzLT5waG90b1snaWQnXSk/ICRwYXJhbSA9ICcgY2xhc3M9ImN1cnJlbnQiJyA6ICcnOwoJ
CQkoJHRoaXMtPmxpc3Rtb2RlID09ICdpbWcnKT8gJHdoYXQgPSAkdGhpcy0+dGh1bWJuYWls
c19pbWcoKSA6ICR3aGF0ID0gJHRoaXMtPnRodW1ibmFpbHNfaW1nX3RpdGxlKCk7CgkJCSgk
dGhpcy0+bGlua3RodW1icyA9PSAxKT8gJHdoYXQgPSAkdGhpcy0+dGh1bWJuYWlsc19saW5r
KCR3aGF0LCAkdGhpcy0+cGhvdG9bInRpdGxlIl0pIDogJyc7CgkJCWlmKCRicmVhayAhPSAn
JykgewoJCQkJKCRicmVhayAhPSAnYnInKT8KCQkJCSRodG1sIC49IHRhZygkd2hhdCwgJGJy
ZWFrLCAkcGFyYW0pIC4gIlxuIjoKCQkJCSRodG1sIC49ICR3aGF0IC4nPGJyIC8+JyAuICJc
biI7CgkJCX0KCQkJZWxzZSB7CgkJCQkkaHRtbCAuPSAkd2hhdCAuICJcbiI7CgkJCX0KCQkJ
dW5zZXQoJHBhcmFtKTsKCQl9CgkJcmV0dXJuICgoJHdyYXB0YWcgIT0gJycpID09IHRydWUp
PyB0YWcoJGh0bWwsICR3cmFwdGFnKSA6ICRodG1sOwoJfQoKCWZ1bmN0aW9uIHRodW1ibmFp
bHNfbnVtYmVyX29mX3Bob3RvcyAoKSB7CgkJcmV0dXJuICR0aGlzLT5udW1iZXJfb2ZfcGhv
dG9zOwoJfQoKCWZ1bmN0aW9uIHRodW1ibmFpbHNfcGVyX3BhZ2UgKCkgewoJCXJldHVybiAk
dGhpcy0+dGh1bWJzX3Blcl9wYWdlOwoJfQoKCWZ1bmN0aW9uIHRodW1ibmFpbHNfY3VycmVu
dF9wYWdlICgpIHsKCQlyZXR1cm4gJHRoaXMtPnBhZ2U7Cgl9CgoJZnVuY3Rpb24gdGh1bWJu
YWlsc190b3RhbF9wYWdlcyAoKSB7CgkJcmV0dXJuICR0aGlzLT5sYXN0cGFnZTsKCX0KCglm
dW5jdGlvbiB0aHVtYm5haWxzX3BhZ2VzX2ZpcnN0ICgkdGhpbmcpIHsKCQlpZiAoaXNzZXQo
JHRoaXMtPnNldCkpICRyZXN1bHQgPSB0YWcocGFyc2UoJHRoaW5nKSwgJ2EnLCAnIGhyZWY9
IicuICR0aGlzLT5tYWtlUmVxdWVzdChhcnJheSgnc2V0JyA9PiAkdGhpcy0+aWQsICdwYWdl
JyA9PiAxKSkgLiciJyk7CgkJaWYgKGlzc2V0KCR0aGlzLT50YWdzKSkgJHJlc3VsdCA9IHRh
ZyhwYXJzZSgkdGhpbmcpLCAnYScsICcgaHJlZj0iJy4gJHRoaXMtPm1ha2VSZXF1ZXN0KGFy
cmF5KCd0YWdzJyA9PiAkdGhpcy0+dGFncywgJ3BhZ2UnID0+IDEpKSAuJyInKTsKCQlpZiAo
aXNzZXQoJHRoaXMtPmxhdGVzdCkpICRyZXN1bHQgPSB0YWcocGFyc2UoJHRoaW5nKSwgJ2En
LCAnIGhyZWY9IicuICR0aGlzLT5tYWtlUmVxdWVzdChhcnJheSgncGFnZScgPT4gMSkpIC4n
IicpOwoJCXJldHVybiAkcmVzdWx0OwoJfQoKCWZ1bmN0aW9uIHRodW1ibmFpbHNfcGFnZXNf
bGFzdCAoJHRoaW5nKSB7CgkJaWYgKGlzc2V0KCR0aGlzLT5zZXQpKSAkcmVzdWx0ID0gdGFn
KHBhcnNlKCR0aGluZyksICdhJywgJyBocmVmPSInLiAkdGhpcy0+bWFrZVJlcXVlc3QoYXJy
YXkoJ3NldCcgPT4gJHRoaXMtPmlkLCAncGFnZScgPT4gJHRoaXMtPmxhc3RwYWdlKSkgLici
Jyk7CgkJaWYgKGlzc2V0KCR0aGlzLT50YWdzKSkgJHJlc3VsdCA9IHRhZyhwYXJzZSgkdGhp
bmcpLCAnYScsICcgaHJlZj0iJy4gJHRoaXMtPm1ha2VSZXF1ZXN0KGFycmF5KCd0YWdzJyA9
PiAkdGhpcy0+dGFncywgJ3BhZ2UnID0+ICR0aGlzLT5sYXN0cGFnZSkpIC4nIicpOwoJCWlm
IChpc3NldCgkdGhpcy0+bGF0ZXN0KSkgJHJlc3VsdCA9IHRhZyhwYXJzZSgkdGhpbmcpLCAn
YScsICcgaHJlZj0iJy4gJHRoaXMtPm1ha2VSZXF1ZXN0KGFycmF5KCdwYWdlJyA9PiAkdGhp
cy0+bGFzdHBhZ2UpKSAuJyInKTsKCQlyZXR1cm4gJHJlc3VsdDsKCX0KCglmdW5jdGlvbiB0
aHVtYm5haWxzX3BhZ2VzX3ByZXZpb3VzICgkdGhpbmcpIHsKCQlpZiAoaXNzZXQoJHRoaXMt
PnNldCkpICRyZXN1bHQgPSB0YWcocGFyc2UoJHRoaW5nKSwgJ2EnLCAnIGhyZWY9IicuICR0
aGlzLT5tYWtlUmVxdWVzdChhcnJheSgnc2V0JyA9PiAkdGhpcy0+aWQsICdwYWdlJyA9PiAk
dGhpcy0+cHJldmlvdXNfcGFnZSkpIC4nIicpOwoJCWlmIChpc3NldCgkdGhpcy0+dGFncykp
ICRyZXN1bHQgPSB0YWcocGFyc2UoJHRoaW5nKSwgJ2EnLCAnIGhyZWY9IicuICR0aGlzLT5t
YWtlUmVxdWVzdChhcnJheSgndGFncycgPT4gJHRoaXMtPnRhZ3MsICdwYWdlJyA9PiAkdGhp
cy0+cHJldmlvdXNfcGFnZSkpIC4nIicpOwoJCWlmIChpc3NldCgkdGhpcy0+bGF0ZXN0KSkg
JHJlc3VsdCA9IHRhZyhwYXJzZSgkdGhpbmcpLCAnYScsICcgaHJlZj0iJy4gJHRoaXMtPm1h
a2VSZXF1ZXN0KGFycmF5KCdwYWdlJyA9PiAkdGhpcy0+cHJldmlvdXNfcGFnZSkpIC4nIicp
OwoJCXJldHVybiAkcmVzdWx0OwoJfQoKCWZ1bmN0aW9uIHRodW1ibmFpbHNfcGFnZXNfbmV4
dCAoJHRoaW5nKSB7CgkJaWYgKGlzc2V0KCR0aGlzLT5zZXQpKSAkcmVzdWx0ID0gdGFnKHBh
cnNlKCR0aGluZyksICdhJywgJyBocmVmPSInLiAkdGhpcy0+bWFrZVJlcXVlc3QoYXJyYXko
J3NldCcgPT4gJHRoaXMtPmlkLCAncGFnZScgPT4gJHRoaXMtPm5leHRfcGFnZSkpIC4nIicp
OwoJCWlmIChpc3NldCgkdGhpcy0+dGFncykpICRyZXN1bHQgPSB0YWcocGFyc2UoJHRoaW5n
KSwgJ2EnLCAnIGhyZWY9IicuICR0aGlzLT5tYWtlUmVxdWVzdChhcnJheSgndGFncycgPT4g
JHRoaXMtPnRhZ3MsICdwYWdlJyA9PiAkdGhpcy0+bmV4dF9wYWdlKSkgLiciJyk7CgkJaWYg
KGlzc2V0KCR0aGlzLT5sYXRlc3QpKSAkcmVzdWx0ID0gdGFnKHBhcnNlKCR0aGluZyksICdh
JywgJyBocmVmPSInLiAkdGhpcy0+bWFrZVJlcXVlc3QoYXJyYXkoJ3BhZ2UnID0+ICR0aGlz
LT5uZXh0X3BhZ2UpKSAuJyInKTsKCQlyZXR1cm4gJHJlc3VsdDsKCX0KCglmdW5jdGlvbiB0
aHVtYm5haWxzX3BhZ2VzX3N0YXJ0dGh1bWIgKCkgewoJCXJldHVybiAkdGhpcy0+c3RhcnQ7
Cgl9CgoJZnVuY3Rpb24gdGh1bWJuYWlsc19wYWdlc19lbmR0aHVtYiAoKSB7CgkJcmV0dXJu
ICR0aGlzLT5lbmQ7Cgl9CgoJZnVuY3Rpb24gdGh1bWJuYWlsc19wYWdlc19saXN0ICgkcGFy
YW1zKSB7CgkJJHBhZ2VzX2FycmF5ID0gcmFuZ2UoMSwgJHRoaXMtPmxhc3RwYWdlKTsKCQlm
b3IgKCRpID0gMDsgJGkgPD0gJHRoaXMtPmxhc3RwYWdlIC0gMTsgJGkrKykgewoJCQlpZiAo
aXNzZXQoJHRoaXMtPnNldCkpICRwYWdlc19hcnJheVskaV0gPSB0YWcoJHBhZ2VzX2FycmF5
WyRpXSwgJ2EnLCAnIGhyZWY9IicuICR0aGlzLT5tYWtlUmVxdWVzdChhcnJheSgnc2V0JyA9
PiAkdGhpcy0+aWQsICdwYWdlJyA9PiAkcGFnZXNfYXJyYXlbJGldKSkgLiciJyk7CgkJCWlm
IChpc3NldCgkdGhpcy0+dGFncykpICRwYWdlc19hcnJheVskaV0gPSB0YWcoJHBhZ2VzX2Fy
cmF5WyRpXSwgJ2EnLCAnIGhyZWY9IicuICR0aGlzLT5tYWtlUmVxdWVzdChhcnJheSgndGFn
cycgPT4gJHRoaXMtPnRhZ3MsICdwYWdlJyA9PiAkcGFnZXNfYXJyYXlbJGldKSkgLiciJyk7
CgkJCWlmIChpc3NldCgkdGhpcy0+bGF0ZXN0KSkgJHBhZ2VzX2FycmF5WyRpXSA9IHRhZygk
cGFnZXNfYXJyYXlbJGldLCAnYScsICcgaHJlZj0iJy4gJHRoaXMtPm1ha2VSZXF1ZXN0KGFy
cmF5KCdwYWdlJyA9PiAkcGFnZXNfYXJyYXlbJGldKSkgLiciJyk7CgkJfQoJCXJldHVybiBk
b1dyYXAoJHBhZ2VzX2FycmF5LCBAJHBhcmFtc1snd3JhcHRhZyddLCBAJHBhcmFtc1snYnJl
YWsnXSwgQCRwYXJhbXNbJ2NsYXNzJ10sIEAkcGFyYW1zWydicmVha2NsYXNzJ10sIEAkcGFy
YW1zWydhdHRzJ10pOwoJfQoKCWZ1bmN0aW9uIHRodW1ibmFpbHNfaWZfbXVsdGlwbGVfcGFn
ZXMgKCR0aGluZykgewoJCSgkdGhpcy0+dGh1bWJzX3Blcl9wYWdlICE9IDApPyAkcmVzdWx0
ID0gcGFyc2UoJHRoaW5nKSA6ICcnOwoJCXJldHVybiAkcmVzdWx0OwoJfQoKCWZ1bmN0aW9u
IF9fdG9TdHJpbmcoKSB7CgkJaWYoISR0aGlzLT54bWwtPmlzVmFsaWQoKSkgewoJCQlyZXR1
cm4gJEdMT0JBTFNbJ3RleHQnXVsnZXJyb3JfbWVzc2FnZSddOwoJCX0KCQkkcmVzdWx0ID0g
cGFyc2UoJHRoaXMtPmZvcm0pOwoJCXJldHVybiAkcmVzdWx0OwoJfQp9CgoKY2xhc3MgUGlj
dHVyZSBleHRlbmRzIFZkaF9GbGlja3IgewoJdmFyICR4bWwsICRpZCwgJHNlY3JldCwgJHNl
cnZlciwgJGRhdGVfdXBsb2FkZWQsICR0aXRsZSwgJGRlc2NyaXB0aW9uLCAkbm90ZXMsICRz
ZXQsICRsaW5rLCAkaW1nLCAkY29udGV4dDsKCXZhciAkaW1nX3NpemUsICRzaG93X2ltZ19u
YXYsICRzaG93X2ltZ190aXRsZSwgJG1ldGhvZCwgJHNldF90aXRsZSwgJGNvbW1lbnRzLCAk
Y29udGV4dF9tb2RlOwoJdmFyICRkYXRlX3Bvc3RlZCwgJGRhdGVfdGFrZW47Cgl2YXIgJHBy
ZXZpb3VzID0gYXJyYXkoKSwgJG5leHQgPSBhcnJheSgpLCAkdGFncyA9IGFycmF5KCksICRy
YXdfdGFncyA9IGFycmF5KCksICR0YWdfaWRzID0gYXJyYXkoKTsKCglmdW5jdGlvbiBQaWN0
dXJlKCRwYXJhbXMpIHsKCQkkdGhpcy0+VmRoX0ZsaWNrcigkcGFyYW1zKTsKCQkoaXNzZXQo
JHBhcmFtc1snaW1nX3NpemUnXSkpPwoJCSR0aGlzLT5pbWdfc2l6ZSA9ICRwYXJhbXNbJ2lt
Z19zaXplJ106CgkJJHRoaXMtPmltZ19zaXplID0gJ24nOwoJCShpc3NldCgkcGFyYW1zWydv
cmlnaW5hbF9zaXplJ10pKT8KCQkkdGhpcy0+b3JpZ2luYWxfc2l6ZSA9ICRwYXJhbXNbJ29y
aWdpbmFsX3NpemUnXToKCQkkdGhpcy0+b3JpZ2luYWxfc2l6ZSA9ICdvJzsKCQkoaXNzZXQo
JHBhcmFtc1snc2V0J10pKT8KCQkkdGhpcy0+c2V0ID0gJHBhcmFtc1snc2V0J106CgkJJHRo
aXMtPnNldCA9ICRfR0VUWydzZXQnXTsKCQkoaXNzZXQoJHBhcmFtc1snaW1nJ10pKT8KCQkk
dGhpcy0+aW1nID0gJHBhcmFtc1snaW1nJ106CgkJJHRoaXMtPmltZyA9ICRfR0VUWydpbWcn
XTsKCQkkbWV0aG9kID0gJ2ZsaWNrci5waG90b3MuZ2V0SW5mbycgLiAkdGhpcy0+dXNlcmRh
dGEgLiAnJnBob3RvX2lkPScgLiAkdGhpcy0+aW1nOwoJCSR0aGlzLT54bWwgPSBuZXcgRmxp
Y2tyKCRtZXRob2QpOwoJCWlmKCR0aGlzLT54bWwtPmlzVmFsaWQoKSkgewoJCQkkdGhpcy0+
aWQgPSBhcnJheV9zaGlmdCgkdGhpcy0+eG1sLT54cGF0aCgnL3JzcC9waG90by9AaWQnKSk7
CgkJCSR0aGlzLT5zZWNyZXQgPSBhcnJheV9zaGlmdCgkdGhpcy0+eG1sLT54cGF0aCgnL3Jz
cC9waG90by9Ac2VjcmV0JykpOwoJCQkkdGhpcy0+b3JpZ2luYWxfc2VjcmV0ID0gYXJyYXlf
c2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoJy9yc3AvcGhvdG8vQG9yaWdpbmFsc2VjcmV0Jykp
OwoJCQkkdGhpcy0+b3JpZ2luYWxfZm9ybWF0ID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+
eHBhdGgoJy9yc3AvcGhvdG8vQG9yaWdpbmFsZm9ybWF0JykpOwoJCQkkdGhpcy0+ZmFybSA9
IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCcvcnNwL3Bob3RvL0BmYXJtJykpOwoJ
CQkkdGhpcy0+c2VydmVyID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoJy9yc3Av
cGhvdG8vQHNlcnZlcicpKTsKCQkJJHRoaXMtPmRhdGVfcG9zdGVkID0gYXJyYXlfc2hpZnQo
JHRoaXMtPnhtbC0+eHBhdGgoJy9yc3AvcGhvdG8vZGF0ZXMvQHBvc3RlZCcpKTsKCQkJJHRo
aXMtPmRhdGVfdGFrZW4gPSBhcnJheV9zaGlmdCgkdGhpcy0+eG1sLT54cGF0aCgnL3JzcC9w
aG90by9kYXRlcy9AdGFrZW4nKSk7CgkJCSR0aGlzLT50aXRsZSA9IGFycmF5X3NoaWZ0KCR0
aGlzLT54bWwtPnhwYXRoKCcvcnNwL3Bob3RvL3RpdGxlL3RleHQoKScpKTsKCQkJJHRoaXMt
PmRlc2NyaXB0aW9uID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoJy9yc3AvcGhv
dG8vZGVzY3JpcHRpb24vdGV4dCgpJykpOwoJCQkkdGhpcy0+Y29tbWVudHMgPSBhcnJheV9z
aGlmdCgkdGhpcy0+eG1sLT54cGF0aCgnL3JzcC9waG90by9jb21tZW50cy90ZXh0KCknKSk7
CgkJCSR0aGlzLT5yYXdfdGFncyA9ICR0aGlzLT54bWwtPnhwYXRoKCcvcnNwL3Bob3RvL3Rh
Z3MvdGFnL0ByYXcnKTsKCQkJJHRoaXMtPnRhZ3MgPSAkdGhpcy0+eG1sLT54cGF0aCgnL3Jz
cC9waG90by90YWdzL3RhZy90ZXh0KCknKTsKCQkJJHRoaXMtPmxpbmsgPSBAJHBhcmFtc1sn
bGluayddOwoJCX0KCQlpZiAoaXNzZXQoJHBhcmFtc1snaW1nX2Zvcm0nXSkpIHsKCQkJJHRo
aXMtPmZvcm0gPSBmZXRjaCgnRm9ybScsJ3R4cF9mb3JtJywibmFtZSIsJHBhcmFtc1snaW1n
X2Zvcm0nXSk7CgkJfQoJCWVsc2UgewoJCQkkdGhpcy0+Zm9ybSA9ICcKCQkJPGRpdiBjbGFz
cz0iaW5kaXZpZHVhbCI+PGRpdiBjbGFzcz0iaW1hZ2UiPgoJCQk8aDIgY2xhc3M9InRpdGxl
Ij48dHhwOnZkaF9mbGlja3JfaW1nX3RpdGxlIC8+PC9oMj4KCQkJPHR4cDp2ZGhfZmxpY2ty
X2ltZ19saW5rPjx0eHA6dmRoX2ZsaWNrcl9pbWdfbmFrZWQgLz48L3R4cDp2ZGhfZmxpY2ty
X2ltZ19saW5rPgoJCQk8ZGl2IGNsYXNzPSJmbGlja3JzZXRuYXYiPgoJCQk8dHhwOnZkaF9m
bGlja3JfaW1nX3ByZXZpb3VzIGxhYmVsPSJwcmV2aW91cyZuYnNwOzombmJzcDsiPiZsYXJy
OzwvdHhwOnZkaF9mbGlja3JfaW1nX3ByZXZpb3VzPgoJCQk8aDIgY2xhc3M9InNldG5hbWUi
Pjx0eHA6dmRoX2ZsaWNrcl9pbWdfc2V0X2xpbms+PHR4cDp2ZGhfZmxpY2tyX2ltZ19zZXRf
dGl0bGUgLz48L3R4cDp2ZGhfZmxpY2tyX2ltZ19zZXRfbGluaz48L2gyPgoJCQk8dHhwOnZk
aF9mbGlja3JfaW1nX25leHQgbGFiZWw9Im5leHQmbmJzcDs6Jm5ic3A7Ij4mcmFycjs8L3R4
cDp2ZGhfZmxpY2tyX2ltZ19uZXh0PgoJCQk8L2Rpdj4KCQkJPGRpdiBjbGFzcz0iZmxpY2ty
X3RhZ19saXN0Ij4KCQkJPHR4cDp2ZGhfZmxpY2tyX2ltZ190YWdzIHNlcGFyYXRvcj0iIHwg
IiAvPgoJCQk8L2Rpdj4KCQkJPGRpdiBjbGFzcz0iZmxpY2tyX2NvbW1lbnRzIj4KCQkJPHR4
cDp2ZGhfZmxpY2tyX2ltZ19udW1iZXJfb2ZfY29tbWVudHMgLz4gQ29tbWVudHMuCgkJCTx0
eHA6dmRoX2ZsaWNrcl9pbWdfY29tbWVudHNfaW52aXRlPlNob3cgYW5kIHBvc3QgY29tbWVu
dHMhPC90eHA6dmRoX2ZsaWNrcl9pbWdfY29tbWVudHNfaW52aXRlPjxiciAvPgoJCQlQb3N0
ZWQgPHR4cDp2ZGhfZmxpY2tyX2ltZ19kYXRlX3Bvc3RlZCAvPi48YnIgLz4KCQkJVGFrZW4g
PHR4cDp2ZGhfZmxpY2tyX2ltZ19kYXRlX3Rha2VuIC8+LjxiciAvPgoJCQk8L2Rpdj4KCQkJ
PHR4cDp2ZGhfZmxpY2tyX2ltZ19pZl9kZXNjcmlwdGlvbj4KCQkJPHAgY2xhc3M9ImltZ19k
ZXNjcmlwdGlvbiI+CgkJCTx0eHA6dmRoX2ZsaWNrcl9pbWdfZGVzY3JpcHRpb24gLz4KCQkJ
PC9wPgoJCQk8L3R4cDp2ZGhfZmxpY2tyX2ltZ19pZl9kZXNjcmlwdGlvbj4KCQkJPC9kaXY+
PC9kaXY+PGRpdiBzdHlsZT0iY2xlYXI6Ym90aDsiPjwvZGl2Pic7CgkJfQoJfQoKCWZ1bmN0
aW9uIGdldENvbnRleHQoKSB7CgkJaWYgKGlzc2V0KCR0aGlzLT5zZXQpKSB7CgkJCSRtZXRo
b2QgPSAnZmxpY2tyLnBob3Rvc2V0cy5nZXRDb250ZXh0JyAuICR0aGlzLT51c2VyZGF0YSAu
ICcmcGhvdG9faWQ9JyAuICR0aGlzLT5pbWcgLiAnJnBob3Rvc2V0X2lkPScgLiAkdGhpcy0+
c2V0OwoJCX0KCQllbHNlIHsKCQkJJG1ldGhvZCA9ICdmbGlja3IucGhvdG9zLmdldENvbnRl
eHQnIC4gJHRoaXMtPnVzZXJkYXRhIC4gJyZwaG90b19pZD0nIC4gJHRoaXMtPmltZzsKCQl9
CgkJJHRoaXMtPnhtbCA9IG5ldyBGbGlja3IoJG1ldGhvZCk7CgkJJHRoaXMtPnByZXZpb3Vz
WydpZCddID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoJy9yc3AvcHJldnBob3Rv
L0BpZCcpKTsKCQkkdGhpcy0+cHJldmlvdXNbJ3RpdGxlJ10gPSBhcnJheV9zaGlmdCgkdGhp
cy0+eG1sLT54cGF0aCgnL3JzcC9wcmV2cGhvdG8vQHRpdGxlJykpOwoJCSR0aGlzLT5wcmV2
aW91c1sndGh1bWInXSA9IGFycmF5X3NoaWZ0KCR0aGlzLT54bWwtPnhwYXRoKCcvcnNwL3By
ZXZwaG90by9AdGh1bWInKSk7CgkJJHRoaXMtPm5leHRbJ2lkJ10gPSBhcnJheV9zaGlmdCgk
dGhpcy0+eG1sLT54cGF0aCgnL3JzcC9uZXh0cGhvdG8vQGlkJykpOwoJCSR0aGlzLT5uZXh0
Wyd0aXRsZSddID0gYXJyYXlfc2hpZnQoJHRoaXMtPnhtbC0+eHBhdGgoJy9yc3AvbmV4dHBo
b3RvL0B0aXRsZScpKTsKCQkkdGhpcy0+bmV4dFsndGh1bWInXSA9IGFycmF5X3NoaWZ0KCR0
aGlzLT54bWwtPnhwYXRoKCcvcnNwL25leHRwaG90by9AdGh1bWInKSk7CgkJJHRoaXMtPmNv
bnRleHQgPSB0cnVlOwoJfQoKCWZ1bmN0aW9uIGltZ19uYWtlZCgpIHsKCQkkcGhvdG8gPSBh
cnJheSgiZmFybSIgPT4gJHRoaXMtPmZhcm0sICJzZXJ2ZXIiID0+ICR0aGlzLT5zZXJ2ZXIs
ICJpZCIgPT4gJHRoaXMtPmlkLCAic2VjcmV0IiA9PiAkdGhpcy0+c2VjcmV0LCAib3JpZ2lu
YWxfc2VjcmV0IiA9PiAkdGhpcy0+b3JpZ2luYWxfc2VjcmV0LCAib3JpZ2luYWxfZm9ybWF0
IiA9PiAkdGhpcy0+b3JpZ2luYWxfZm9ybWF0KTsKCQkkaW1nX3VybCA9ICR0aGlzLT5nZXRQ
aG90b1VybCgkcGhvdG8sICR0aGlzLT5pbWdfc2l6ZSk7CgkJJGltZ191cmwgPSAnPGltZyBz
cmM9IicgLiAkaW1nX3VybCAuICciIGFsdD0iJyAuICR0aGlzLT50aXRsZSAuICciIC8+JzsK
CQlyZXR1cm4gJGltZ191cmw7Cgl9CgoJZnVuY3Rpb24gaW1nX2xpbmsoJGltZ191cmwpIHsK
CQlpZiAoaXNzZXQoJHRoaXMtPmxpbmspKXsKCQkJc3dpdGNoKCR0aGlzLT5saW5rKSB7CgkJ
CQljYXNlICJmbGlja3IiOgoJCQkJJGxpbmtfdGFyZ2V0ID0gJ2h0dHA6Ly93d3cuZmxpY2ty
LmNvbS9waG90b3MvJyAuIHVybGVuY29kZSgkdGhpcy0+bnNpZCkgLiAnLycgLiAkdGhpcy0+
aWQgLiAnLyc7CgkJCQlicmVhazsKCQkJCWNhc2UgIm9yaWdpbmFsX3NpemUiIHx8ICJsaWdo
dGJveCI6CgkJCQkkcGhvdG8gPSBhcnJheSgiZmFybSIgPT4gJHRoaXMtPmZhcm0sICJzZXJ2
ZXIiID0+ICR0aGlzLT5zZXJ2ZXIsICJpZCIgPT4gJHRoaXMtPmlkLCAic2VjcmV0IiA9PiAk
dGhpcy0+c2VjcmV0LCAib3JpZ2luYWxfc2VjcmV0IiA9PiAkdGhpcy0+b3JpZ2luYWxfc2Vj
cmV0LCAib3JpZ2luYWxfZm9ybWF0IiA9PiAkdGhpcy0+b3JpZ2luYWxfZm9ybWF0KTsKCQkJ
CSRsaW5rX3RhcmdldCA9ICR0aGlzLT5nZXRQaG90b1VybCgkcGhvdG8sICR0aGlzLT5vcmln
aW5hbF9zaXplKTsKCQkJCWJyZWFrOwoJCQkJY2FzZSAiaW1nX2luZm9ybWF0aW9uIjoKCQkJ
CSRsaW5rX3RhcmdldCA9ICdodHRwOi8vd3d3LmZsaWNrci5jb20vcGhvdG9fZXhpZi5nbmU/
aWQ9JyAuICR0aGlzLT5pZDsKCQkJCWJyZWFrOwoJCQl9CgkJCSRsaW5rX2F0dHJpYnV0ZXMg
PSAnIGhyZWY9IicgLiAkbGlua190YXJnZXQgLiAnIic7CgkJCWlmICgkdGhpcy0+bGluayA9
PSAibGlnaHRib3giKSB7CgkJCQkkbGlua19hdHRyaWJ1dGVzIC49ICcgcmVsPSJsaWdodGJv
eCInOwoJCQl9CgkJCSRpbWdfdXJsID0gdGFnKCRpbWdfdXJsLCAnYScsICRsaW5rX2F0dHJp
YnV0ZXMpOwoJCQkkaW1nX3VybCAuPSAiXG4iOwoJCX0KCQlyZXR1cm4gJGltZ191cmw7Cgl9
CgoJZnVuY3Rpb24gaW1nX3ByZXZpb3VzKCRsYWJlbCwgJHRoaW5nKSB7CgkJaWYgKCFpc3Nl
dCgkdGhpcy0+Y29udGV4dCkpICR0aGlzLT5nZXRDb250ZXh0KCk7CgkJJHRoaXMtPnByZXZp
b3VzWydpZCddID0gKGZsb2F0KSAoJHRoaXMtPnByZXZpb3VzWydpZCddKTsKCQlpZiAoJHRo
aXMtPnByZXZpb3VzWydpZCddICE9IDApIHsKCQkJJHRpdGxlID0gICR0aGlzLT5wcmV2aW91
c1sndGl0bGUnXTsKCQkJJGVuZCA9ICciIHRpdGxlPSInLiAkbGFiZWwgLiAkdGl0bGU7CgkJ
CWlmIChpc3NldCgkdGhpcy0+c2V0KSkgJGh0bWwgPSB0YWcoJHRoaW5nLCdhJywnIGhyZWY9
IicuICR0aGlzLT5tYWtlUmVxdWVzdChhcnJheSgnc2V0JyA9PiAkdGhpcy0+c2V0LCAnaW1n
JyA9PiAkdGhpcy0+cHJldmlvdXNbJ2lkJ10pKSAuJGVuZC4nIicpLiJcbiI7CgkJCWVsc2Ug
JGh0bWwgPSB0YWcoJHRoaW5nLCdhJywnIGhyZWY9IicuICR0aGlzLT5tYWtlUmVxdWVzdChh
cnJheSgnaW1nJyA9PiAkdGhpcy0+cHJldmlvdXNbJ2lkJ10pKSAuJGVuZC4nIicpLiJcbiI7
CgkJfQoJCXJldHVybiAkaHRtbDsKCX0KCglmdW5jdGlvbiBpbWdfcHJldmlvdXNfdGh1bWJu
YWlsKCkgewoJCWlmICghaXNzZXQoJHRoaXMtPmNvbnRleHQpKSAkdGhpcy0+Z2V0Q29udGV4
dCgpOwoJCSR0aGlzLT5wcmV2aW91c1snaWQnXSA9IChmbG9hdCkgKCR0aGlzLT5wcmV2aW91
c1snaWQnXSk7CgkJaWYgKCR0aGlzLT5wcmV2aW91c1snaWQnXSAhPSAwKSB7CgkJCSRyZXN1
bHQgPSAnPGltZyBzcmM9IicgLiAkdGhpcy0+cHJldmlvdXNbJ3RodW1iJ10gLiAnIiBhbHQ9
IicgLiAkdGl0bGUgLiAnIiAvPic7CgkJfQoJCXJldHVybiAkcmVzdWx0OwoJfQoKCWZ1bmN0
aW9uIGltZ19uZXh0KCRsYWJlbCwgJHRoaW5nKSB7CgkJaWYgKCFpc3NldCgkdGhpcy0+Y29u
dGV4dCkpICR0aGlzLT5nZXRDb250ZXh0KCk7CgkJJHRoaXMtPm5leHRbJ2lkJ10gPSAoZmxv
YXQpICgkdGhpcy0+bmV4dFsnaWQnXSk7CgkJaWYgKCR0aGlzLT5uZXh0WydpZCddICE9IDAp
IHsKCQkJJHRpdGxlID0gICR0aGlzLT5uZXh0Wyd0aXRsZSddOwoJCQkkZW5kID0gJyIgdGl0
bGU9IicuICRsYWJlbCAuICR0aXRsZTsKCQkJaWYgKGlzc2V0KCR0aGlzLT5zZXQpKSAkaHRt
bCA9IHRhZygkdGhpbmcsJ2EnLCcgaHJlZj0iJy4gJHRoaXMtPm1ha2VSZXF1ZXN0KGFycmF5
KCdzZXQnID0+ICR0aGlzLT5zZXQsICdpbWcnID0+ICR0aGlzLT5uZXh0WydpZCddKSkgLiRl
bmQuJyInKS4iXG4iOwoJCQllbHNlICRodG1sID0gdGFnKCR0aGluZywnYScsJyBocmVmPSIn
LiAkdGhpcy0+bWFrZVJlcXVlc3QoYXJyYXkoJ2ltZycgPT4gJHRoaXMtPm5leHRbJ2lkJ10p
KSAuJGVuZC4nIicpLiJcbiI7CgkJfQoJCXJldHVybiAkaHRtbDsKCX0KCglmdW5jdGlvbiBp
bWdfbmV4dF90aHVtYm5haWwoKSB7CgkJaWYgKCFpc3NldCgkdGhpcy0+Y29udGV4dCkpICR0
aGlzLT5nZXRDb250ZXh0KCk7CgkJJHRoaXMtPm5leHRbJ2lkJ10gPSAoZmxvYXQpICgkdGhp
cy0+bmV4dFsnaWQnXSk7CgkJaWYgKCR0aGlzLT5uZXh0WydpZCddICE9IDApIHsKCQkJJHJl
c3VsdCA9ICc8aW1nIHNyYz0iJyAuICR0aGlzLT5uZXh0Wyd0aHVtYiddIC4gJyIgYWx0PSIn
IC4gJHRpdGxlIC4gJyIgLz4nOwoJCX0KCQlyZXR1cm4gJHJlc3VsdDsKCX0KCglmdW5jdGlv
biBpbWdfc2V0X3RpdGxlKCkgewoJCWlmIChpc3NldCgkdGhpcy0+c2V0KSkgewoJCQkkbWV0
aG9kID0gJ2ZsaWNrci5waG90b3NldHMuZ2V0SW5mbycgLiAkdGhpcy0+dXNlcmRhdGEgLiAn
JnBob3Rvc2V0X2lkPScgLiAkdGhpcy0+c2V0OwoJCQkkeG1sID0gbmV3IEZsaWNrcigkbWV0
aG9kKTsKCQkJJHRoaXMtPnNldF90aXRsZSA9IGFycmF5X3NoaWZ0KCR4bWwtPnhwYXRoKCcv
cnNwL3Bob3Rvc2V0L3RpdGxlL3RleHQoKScpKTsKCQkJcmV0dXJuICR0aGlzLT5zZXRfdGl0
bGU7CgkJfQoJCXJldHVybiAnJzsKCX0KCglmdW5jdGlvbiBpbWdfc2V0X2xpbmsoJHRoaW5n
KSB7CgkJaWYgKGlzc2V0KCR0aGlzLT5zZXQpKSB7CgkJCXJldHVybiB0YWcoJHRoaW5nLCAn
YScsICcgaHJlZj0iJy4gJHRoaXMtPm1ha2VSZXF1ZXN0KGFycmF5KCdzZXQnID0+ICR0aGlz
LT5zZXQpKSAuJyInKTsKCQl9CgkJcmV0dXJuICcnOwoJfQoKCWZ1bmN0aW9uIGltZ19uYXYo
KSB7CgkJJGh0bWwgLj0gJHRoaXMtPmltZ19wcmV2aW91cygpOwoJCSRodG1sIC49ICc8aDIg
Y2xhc3M9InNldG5hbWUiPicgLiAkdGhpcy0+aW1nX3NldF90aXRsZSgpIC4gJzwvaDI+JyAu
ICJcbiI7CgkJJGh0bWwgLj0gJHRoaXMtPmltZ19uZXh0KCk7CgkJcmV0dXJuICRodG1sOwoJ
fQoKCWZ1bmN0aW9uIGltZ190aXRsZSgpIHsKCQlyZXR1cm4gJHRoaXMtPnRpdGxlOwoJfQoK
CWZ1bmN0aW9uIGltZ19kZXNjcmlwdGlvbigpIHsKCQkkZGVzY3JpcHRpb25fc3RyaW5nID0g
KHN0cmluZykgJHRoaXMtPmRlc2NyaXB0aW9uOwoJCWlmICgkZGVzY3JpcHRpb25fc3RyaW5n
ICE9ICdBcnJheScpIHJldHVybiAkZGVzY3JpcHRpb25fc3RyaW5nOwoJfQoKCWZ1bmN0aW9u
IGltZ19pZl9kZXNjcmlwdGlvbiAoJHRoaW5nKSB7CgkJaWYgKCR0aGlzLT5kZXNjcmlwdGlv
biAhPSAnJm5ic3A7JyBhbmQgIWVtcHR5KCR0aGlzLT5kZXNjcmlwdGlvbikpICRyZXN1bHQg
PSBwYXJzZSgkdGhpbmcpOwoJCWVsc2UgJHJlc3VsdCA9ICcnOwoJCXJldHVybiAkcmVzdWx0
OwoJfQoKCWZ1bmN0aW9uIGltZ190YWdzKCRzZXBhcmF0b3IpIHsKCQkkaHRtbCA9IHRhZygk
dGhpcy0+cmF3X3RhZ3NbMF0sJ2EnLCcgaHJlZj0iJyAuICR0aGlzLT5tYWtlUmVxdWVzdChh
cnJheSgndGFncycgPT4gJHRoaXMtPnRhZ3NbMF0pKSAuICciJykuIlxuIjsKCQlmb3IoJGkg
PSAxOyAkaSA8IHNpemVvZigkdGhpcy0+dGFncyk7ICRpKyspIHsKCQkJJGh0bWwgLj0gJHNl
cGFyYXRvcjsKCQkJJGh0bWwgLj0gdGFnKCR0aGlzLT5yYXdfdGFnc1skaV0sJ2EnLCcgaHJl
Zj0iJyAuICR0aGlzLT5tYWtlUmVxdWVzdChhcnJheSgndGFncycgPT4gJHRoaXMtPnRhZ3Nb
JGldKSkgLiAnIicpLiJcbiI7CgkJfQoJCXJldHVybiAkaHRtbDsKCX0KCglmdW5jdGlvbiBp
bWdfbnVtYmVyX29mX2NvbW1lbnRzKCkgewoJCXJldHVybiAkdGhpcy0+Y29tbWVudHM7Cgl9
CgoJZnVuY3Rpb24gaW1nX2NvbW1lbnRzX2ludml0ZSgkaW52aXRldGV4dCkgewoJCXJldHVy
biB0YWcoJGludml0ZXRleHQsJ2EnLCcgaHJlZj0iJyAuICdodHRwOi8vd3d3LmZsaWNrci5j
b20vcGhvdG9zLycgLiB1cmxlbmNvZGUoJHRoaXMtPm5zaWQpIC4gJy8nIC4gJHRoaXMtPmlk
IC4gJy8iJyk7Cgl9CgoJZnVuY3Rpb24gaW1nX2RhdGVfcG9zdGVkKCRwYXJhbXMpIHsKCQlp
ZiAoaXNzZXQoJHBhcmFtc1snZm9ybWF0J10pKSByZXR1cm4gc2FmZV9zdHJmdGltZSgkcGFy
YW1zWydmb3JtYXQnXSwgJHRoaXMtPmRhdGVfcG9zdGVkKTsKCQlnbG9iYWwgJGFyY2hpdmVf
ZGF0ZWZvcm1hdDsKCQlyZXR1cm4gc2FmZV9zdHJmdGltZSgkYXJjaGl2ZV9kYXRlZm9ybWF0
LCAkdGhpcy0+ZGF0ZV9wb3N0ZWQpOwoJfQoKCWZ1bmN0aW9uIGltZ19kYXRlX3Rha2VuKCRw
YXJhbXMpIHsKCQlpZiAoaXNzZXQoJHBhcmFtc1snZm9ybWF0J10pKSByZXR1cm4gc2FmZV9z
dHJmdGltZSgkcGFyYW1zWydmb3JtYXQnXSwgc3RydG90aW1lKCR0aGlzLT5kYXRlX3Rha2Vu
KSk7CgkJZ2xvYmFsICRhcmNoaXZlX2RhdGVmb3JtYXQ7CgkJcmV0dXJuIHNhZmVfc3RyZnRp
bWUoJGFyY2hpdmVfZGF0ZWZvcm1hdCwgc3RydG90aW1lKCR0aGlzLT5kYXRlX3Rha2VuKSk7
Cgl9CgoJZnVuY3Rpb24gX190b1N0cmluZygpIHsKCQlpZighJHRoaXMtPnhtbC0+aXNWYWxp
ZCgpKSB7CgkJCXJldHVybiAkR0xPQkFMU1sndGV4dCddWydlcnJvcl9tZXNzYWdlJ107CgkJ
fQoJCSRyZXN1bHQgPSBwYXJzZSgkdGhpcy0+Zm9ybSk7CgkJcmV0dXJuICRyZXN1bHQ7Cgl9
Cn0KCgpjbGFzcyBUYWdsaXN0IGV4dGVuZHMgVmRoX0ZsaWNrciB7Cgl2YXIgJHhtbCwgJHRh
Z2xpc3QsICRjb3VudCwgJHNvdXJjZV90YWc7CgoJZnVuY3Rpb24gVGFnbGlzdCgkcGFyYW1z
KSB7CgkJJHRoaXMtPlZkaF9GbGlja3IoJHBhcmFtcyk7Cgl9CgoJZnVuY3Rpb24gbGlzdF9h
bGwoJHBhcmFtcykgewoJCSRtZXRob2QgPSAnZmxpY2tyLnRhZ3MuZ2V0TGlzdFVzZXInIC4g
JHRoaXMtPnVzZXJkYXRhOwoJCXJldHVybiAkdGhpcy0+Z2VuZXJhdGVMaXN0KCRtZXRob2Qs
ICRwYXJhbXMpOwoJfQoKCWZ1bmN0aW9uIGxpc3RfcG9wdWxhcigkcGFyYW1zKSB7CgkJaXNz
ZXQoJHBhcmFtc1snY291bnQnXSk/ICR0aGlzLT5jb3VudCA9ICRwYXJhbXNbJ2NvdW50J10g
OiAkdGhpcy0+Y291bnQgPSAxMDsKCQkkbWV0aG9kID0gJ2ZsaWNrci50YWdzLmdldExpc3RV
c2VyUG9wdWxhcicgLiAkdGhpcy0+dXNlcmRhdGEgLiAnJmNvdW50PScgLiAkdGhpcy0+Y291
bnQ7CgkJcmV0dXJuICR0aGlzLT5nZW5lcmF0ZUxpc3QoJG1ldGhvZCwgJHBhcmFtcyk7Cgl9
CgoJZnVuY3Rpb24gbGlzdF9yZWxhdGVkKCRwYXJhbXMpIHsKCQlpc3NldCgkcGFyYW1zWydz
b3VyY2VfdGFnJ10pPyAkdGhpcy0+c291cmNlX3RhZyA9ICRwYXJhbXNbJ3NvdXJjZV90YWcn
XSA6ICR0aGlzLT5zb3VyY2VfdGFnID0gJyc7CgkJJG1ldGhvZCA9ICdmbGlja3IudGFncy5n
ZXRSZWxhdGVkJyAuICR0aGlzLT51c2VyZGF0YSAuICcmdGFnPScgLiAkdGhpcy0+c291cmNl
X3RhZzsKCQlyZXR1cm4gJHRoaXMtPmdlbmVyYXRlTGlzdCgkbWV0aG9kLCAkcGFyYW1zKTsK
CX0KCglmdW5jdGlvbiBnZW5lcmF0ZUxpc3QgKCRtZXRob2QsICRwYXJhbXMpIHsKCQkkdGhp
cy0+eG1sID0gbmV3IEZsaWNrcigkbWV0aG9kKTsKCQlpZigkdGhpcy0+eG1sLT5pc1ZhbGlk
KCkpIHsKCQkJJHRoaXMtPnRhZ2xpc3QgPSAkdGhpcy0+eG1sLT54cGF0aCgnLy90YWdzL3Rh
Zy90ZXh0KCknKTsKCQl9CgkJZm9yICgkaSA9IDA7ICRpIDw9IHNpemVvZigkdGhpcy0+dGFn
bGlzdCkgLSAxOyAkaSsrKSB7CgkJCSR0aGlzLT50YWdsaXN0WyRpXSA9IHRhZygkdGhpcy0+
dGFnbGlzdFskaV0sJ2EnLCcgaHJlZj0iJyAuICR0aGlzLT5tYWtlUmVxdWVzdChhcnJheSgn
dGFncycgPT4gJHRoaXMtPnRhZ2xpc3RbJGldKSkgLiAnIicpOwoJCX0KCQlyZXR1cm4gZG9X
cmFwKCR0aGlzLT50YWdsaXN0LCAkcGFyYW1zWyd3cmFwdGFnJ10sICRwYXJhbXNbJ2JyZWFr
J10sICRwYXJhbXNbJ2NsYXNzJ10sICRwYXJhbXNbJ2JyZWFrY2xhc3MnXSwgJHBhcmFtc1sn
YXR0cyddKTsKCX0KCglmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewoJCXJldHVybiAkdGhpcy0+
bGlzdF9hbGw7Cgl9Cn0KCgpjbGFzcyBGbGlja3IgewoJdmFyICR4bWx1cmwgPSAnaHR0cDov
L3d3dy5mbGlja3IuY29tL3NlcnZpY2VzL3Jlc3QvP21ldGhvZD0nOwoJdmFyICR4bWw7CgoJ
ZnVuY3Rpb24gRmxpY2tyKCRtZXRob2QpIHsKCQkvLyR0aW1lX3N0YXJ0ID0gbWljcm90aW1l
KHRydWUpOwoJCSR0aGlzLT54bWx1cmwgLj0gJG1ldGhvZDsKCQlpZihpc3NldCgkR0xPQkFM
U1sndXNlX3BocDQnXSkpIHsKCQkJaWYgKGZ1bmN0aW9uX2V4aXN0cygnY3VybF9pbml0Jykp
IHsKCQkJCSRjaCA9IEBjdXJsX2luaXQoKTsKCQkJCWN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9Q
VF9VUkwsICR0aGlzLT54bWx1cmwpOwoJCQkJY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hF
QURFUiwgMCk7CgkJCQljdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIs
IDEpOwoJCQkJJHJlc3AgPSBjdXJsX2V4ZWMoJGNoKTsKCQkJCWN1cmxfY2xvc2UoJGNoKTsK
CQkJCWlmKCRkb20gPSBAZG9teG1sX29wZW5fbWVtKCRyZXNwKSkgewoJCQkJCSR0aGlzLT54
bWwgPSB4cGF0aF9uZXdfY29udGV4dCgkZG9tKTsKCQkJCX0KCQkJfQoJCQllbHNlIGlmICgk
cmVzcCA9IEBmaWxlX2dldF9jb250ZW50cygkdGhpcy0+eG1sdXJsKSkgewoJCQkJaWYoJGRv
bSA9IEBkb214bWxfb3Blbl9tZW0oJHJlc3ApKSB7CgkJCQkJJHRoaXMtPnhtbCA9IHhwYXRo
X25ld19jb250ZXh0KCRkb20pOwoJCQkJfQoJCQl9CgkJCWVsc2UgaWYgKGZ1bmN0aW9uX2V4
aXN0cygnZG9teG1sX29wZW5fZmlsZScpKXsKCQkJCSRkb20gPSBAZG9teG1sX29wZW5fZmls
ZSgkdGhpcy0+eG1sdXJsKTsKCQkJCSR0aGlzLT54bWwgPSB4cGF0aF9uZXdfY29udGV4dCgk
ZG9tKTsKCQkJfQoJCX0KCQllbHNlIHsKCQkJaWYoISR0aGlzLT54bWwgPSBAc2ltcGxleG1s
X2xvYWRfZmlsZSgkdGhpcy0+eG1sdXJsKSkgewoJCQkJdW5zZXQoJHRoaXMtPnhtbCk7CgkJ
CX0KCQl9CgkJLy9lY2hvIG4sY29tbWVudCgoJ3J1bnRpbWUgZm9yICcgLiAkbWV0aG9kLiAn
OiAnIC4gKG1pY3JvdGltZSh0cnVlKSAtICR0aW1lX3N0YXJ0KSAuICI8YnIgLz5cbiIpKTsK
CX0KCglmdW5jdGlvbiBpc1ZhbGlkKCkgewoJCWlmKGlzc2V0KCR0aGlzLT54bWwpKSB7CgkJ
CSRyZXMgPSBhcnJheV9zaGlmdCgkdGhpcy0+eHBhdGgoJy9yc3AvQHN0YXQnKSk7CgkJCWlm
ICgkcmVzID09ICdmYWlsJykgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCXJldHVybiB0
cnVlOwoJCX0KCQllbHNlIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCX0KCglmdW5jdGlvbiB4
cGF0aCgkcGF0aCkgewoJCWlmKCFpc3NldCgkdGhpcy0+eG1sKSkgewoJCQlyZXR1cm4gTlVM
TDsKCQl9CgkJaWYoaXNzZXQoJEdMT0JBTFNbJ3VzZV9waHA0J10pKSB7CgkJCSRyZXN1bHQg
PSB4cGF0aF9ldmFsX2V4cHJlc3Npb24oJHRoaXMtPnhtbCwgJHBhdGgpOwoJCQkkcmVzdWx0
ID0gJHJlc3VsdC0+bm9kZXNldDsKCQkJLy8gQ29udmVydCB0byBTdHJpbmc6CgkJCWZvcigk
aXRlcmF0b3IgPSAwOyAkaXRlcmF0b3IgPCBjb3VudCgkcmVzdWx0KTsgJGl0ZXJhdG9yKysp
IHsKCQkJCSRyZXN1bHRbJGl0ZXJhdG9yXSA9ICRyZXN1bHRbJGl0ZXJhdG9yXS0+Z2V0X2Nv
bnRlbnQoKTsKCQkJfQoJCQlyZXR1cm4gJHJlc3VsdDsKCQl9CgkJZWxzZSB7CgkJCSRyZXN1
bHQgPSAkdGhpcy0+eG1sLT54cGF0aCgkcGF0aCk7CgkJCS8vIENvbnZlcnQgdG8gU3RyaW5n
OgoJCQlmb3IoJGl0ZXJhdG9yID0gMDsgJGl0ZXJhdG9yIDwgY291bnQoJHJlc3VsdCk7ICRp
dGVyYXRvcisrKSB7CgkJCQkkcmVzdWx0WyRpdGVyYXRvcl0gPSAoc3RyaW5nKSAkcmVzdWx0
WyRpdGVyYXRvcl07CgkJCX0KCQkJcmV0dXJuICRyZXN1bHQ7CgkJfQoJfQp9CgpmdW5jdGlv
biB2ZGhfZmxpY2tyKCRwYXJhbXMpIHsKCWlmKGlzc2V0KCRfR0VUWydpbWcnXSkpIHsKCQly
ZXR1cm4gdmRoX2ZsaWNrcl9pbWcoJHBhcmFtcyk7Cgl9CglpZihpc3NldCgkX0dFVFsndGFn
cyddKSkgewoJCXJldHVybiB2ZGhfZmxpY2tyX3RodW1ibmFpbHMoJHBhcmFtcyk7Cgl9Cglp
Zihpc3NldCgkX0dFVFsnc2V0J10pKSB7CgkJcmV0dXJuIHZkaF9mbGlja3JfdGh1bWJuYWls
cygkcGFyYW1zKTsKCX0KCWdsb2JhbCAkZ2FsOwoJLy8oKGlzc2V0ICgkZ2FsKSk9PWZhbHNl
KT8gJGdhbCA9IG5ldyBHYWxsZXJ5KCRwYXJhbXMpIDogJyc7CglpZiAoIWVtcHR5KCRwYXJh
bXMpKSAkZ2FsID0gbmV3IEdhbGxlcnkoJHBhcmFtcyk7CglyZXR1cm4gJGdhbC0+X190b1N0
cmluZygpOwp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX3RodW1ibmFpbHMoJHBhcmFtcykgewoJ
aWYoaXNzZXQoJF9HRVRbJ2ltZyddKSkgewoJCXJldHVybiB2ZGhfZmxpY2tyX2ltZygkcGFy
YW1zKTsKCX0KCWdsb2JhbCAkdGh1bWJzOwoJLy8oKGlzc2V0ICgkdGh1bWJzKSk9PWZhbHNl
KT8gJHRodW1icyA9IG5ldyBUaHVtYm5haWxzKCRwYXJhbXMpIDogJyc7CglpZiAoIWVtcHR5
KCRwYXJhbXMpKSAkdGh1bWJzID0gbmV3IFRodW1ibmFpbHMoJHBhcmFtcyk7CglyZXR1cm4g
JHRodW1icy0+X190b1N0cmluZygpOwp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX2ltZygkcGFy
YW1zKSB7CglnbG9iYWwgJHNpbmdsZWltZzsKCS8vKChpc3NldCAoJHNpbmdsZWltZykpPT1m
YWxzZSk/ICRzaW5nbGVpbWcgPSBuZXcgUGljdHVyZSgkcGFyYW1zKSA6ICcnOwoJaWYgKCFl
bXB0eSgkcGFyYW1zKSkgJHNpbmdsZWltZyA9IG5ldyBQaWN0dXJlKCRwYXJhbXMpOwoJcmV0
dXJuICRzaW5nbGVpbWctPl9fdG9TdHJpbmcoKTsKfQoKLy9uZXVlIHR4cCB0YWdzCgpnbG9i
YWwgJHZkaF9mbGlja3I7CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX3NldF9pbWcgKCRwYXJhbXMp
IHsKCWdsb2JhbCAkZ2FsOwoJcmV0dXJuICRnYWwtPnNldF9pbWcoJHBhcmFtcyk7Cn0KCmZ1
bmN0aW9uIHZkaF9mbGlja3Jfc2V0X3RpdGxlICgkcGFyYW1zKSB7CglnbG9iYWwgJGdhbDsK
CXJldHVybiAkZ2FsLT5zZXRfdGl0bGUoJHBhcmFtcyk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlj
a3Jfc2V0X2Rlc2NyaXB0aW9uICgpIHsKCWdsb2JhbCAkZ2FsOwoJcmV0dXJuICRnYWwtPnNl
dF9kZXNjcmlwdGlvbigpOwp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX3NldF9udW1iZXJfb2Zf
cGhvdG9zICgpIHsKCWdsb2JhbCAkZ2FsOwoJcmV0dXJuICRnYWwtPnNldF9udW1iZXJfb2Zf
cGhvdG9zKCk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3Jfc2V0X2xpbmsgKCRwYXJhbXMsICR0
aGluZykgewoJJHJlc3VsdCA9IHBhcnNlKCR0aGluZyk7CglnbG9iYWwgJGdhbDsKCXJldHVy
biAkZ2FsLT5zZXRfbGluaygkcGFyYW1zLCAkcmVzdWx0KTsKfQoKZnVuY3Rpb24gdmRoX2Zs
aWNrcl9zZXRfbGlzdCAoJHBhcmFtcykgewoJZ2xvYmFsICRnYWw7CgkoKGlzc2V0ICgkZ2Fs
KSk9PWZhbHNlKT8gJGdhbCA9IG5ldyBHYWxsZXJ5KCRwYXJhbXMpIDogJyc7CglyZXR1cm4g
JGdhbC0+c2V0X2xpc3QoJHBhcmFtcyk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfdGFnX2xp
c3RfYWxsICgkcGFyYW1zKSB7CgkkdGFnbGFsYWxhID0gbmV3IFRhZ2xpc3QoJHBhcmFtcyk7
CglyZXR1cm4gJHRhZ2xhbGFsYS0+bGlzdF9hbGwoJHBhcmFtcyk7Cn0KCmZ1bmN0aW9uIHZk
aF9mbGlja3JfdGFnX2xpc3RfcG9wdWxhciAoJHBhcmFtcykgewoJJHRhZ2xhbGFsYSA9IG5l
dyBUYWdsaXN0KCRwYXJhbXMpOwoJcmV0dXJuICR0YWdsYWxhbGEtPmxpc3RfcG9wdWxhcigk
cGFyYW1zKTsKfQoKZnVuY3Rpb24gdmRoX2ZsaWNrcl90YWdfbGlzdF9yZWxhdGVkICgkcGFy
YW1zKSB7CgkkdGFnbGFsYWxhID0gbmV3IFRhZ2xpc3QoJHBhcmFtcyk7CglyZXR1cm4gJHRh
Z2xhbGFsYS0+bGlzdF9yZWxhdGVkKCRwYXJhbXMpOwp9CgpmdW5jdGlvbiB2ZGhfZmxpY2ty
X3RodW1ibmFpbHNfdGl0bGUgKCkgewoJZ2xvYmFsICR0aHVtYnM7CglyZXR1cm4gJHRodW1i
cy0+dGh1bWJuYWlsc190aXRsZSgpOwp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX3RodW1ibmFp
bHNfZGVzY3JpcHRpb24gKCkgewoJZ2xvYmFsICR0aHVtYnM7CglyZXR1cm4gJHRodW1icy0+
dGh1bWJuYWlsc19kZXNjcmlwdGlvbigpOwp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX3RodW1i
bmFpbHNfaWZfZGVzY3JpcHRpb24gKCRwYXJhbXMsICR0aGluZykgewoJZ2xvYmFsICR0aHVt
YnM7CglyZXR1cm4gJHRodW1icy0+dGh1bWJuYWlsc19pZl9kZXNjcmlwdGlvbigkdGhpbmcp
Owp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX3RodW1ibmFpbHNfc2xpZGVzaG93ICgkcGFyYW1z
LCAkdGhpbmcpIHsKCSRyZXN1bHQgPSBwYXJzZSgkdGhpbmcpOwoJZ2xvYmFsICR0aHVtYnM7
CglyZXR1cm4gJHRodW1icy0+dGh1bWJuYWlsc19zbGlkZXNob3coJHJlc3VsdCk7Cn0KCmZ1
bmN0aW9uIHZkaF9mbGlja3JfdGh1bWJuYWlsc19pbWcgKCkgewoJZ2xvYmFsICR0aHVtYnM7
CglyZXR1cm4gJHRodW1icy0+dGh1bWJuYWlsc19pbWcoKTsKfQoKZnVuY3Rpb24gdmRoX2Zs
aWNrcl90aHVtYm5haWxzX2ltZ190aXRsZSAoKSB7CglnbG9iYWwgJHRodW1iczsKCXJldHVy
biAkdGh1bWJzLT50aHVtYm5haWxzX2ltZ190aXRsZSgpOwp9CgpmdW5jdGlvbiB2ZGhfZmxp
Y2tyX3RodW1ibmFpbHNfbGluayAoJHBhcmFtcywgJHRoaW5nKSB7CgkkcmVzdWx0ID0gcGFy
c2UoJHRoaW5nKTsKCWdsb2JhbCAkdGh1bWJzOwoJcmV0dXJuICR0aHVtYnMtPnRodW1ibmFp
bHNfbGluaygkcmVzdWx0KTsKfQoKZnVuY3Rpb24gdmRoX2ZsaWNrcl90aHVtYm5haWxzX2xp
c3QgKCRwYXJhbXMpIHsKCWdsb2JhbCAkdGh1bWJzOwoJaWYgKGlzc2V0KCRfR0VUWydzZXQn
XSkgb3IgaXNzZXQoJF9HRVRbJ3RhZ3MnXSkgb3IgaXNzZXQoJHBhcmFtc1snc2V0J10pIG9y
IGlzc2V0KCRwYXJhbXNbJ3RhZ3MnXSkgb3IgaXNzZXQoJHBhcmFtc1snbGF0ZXN0J10pKSB7
CgkJaWYgKChpc3NldCAoJHRodW1icykpPT1mYWxzZSkgJHRodW1icyA9IG5ldyBUaHVtYm5h
aWxzKCRwYXJhbXMpOwoJfQoJaWYgKGlzc2V0KCRfR0VUWydzZXQnXSkgb3IgaXNzZXQoJF9H
RVRbJ3RhZ3MnXSkgb3IgaXNzZXQoJHRodW1icy0+c2V0KSBvciBpc3NldCgkdGh1bWJzLT50
YWdzKSBvciBpc3NldCgkdGh1bWJzLT5sYXRlc3QpKSB7CgkJcmV0dXJuICR0aHVtYnMtPnRo
dW1ibmFpbHNfbGlzdCgkcGFyYW1zKTsKCX0KCXJldHVybiBmYWxzZTsKfQoKZnVuY3Rpb24g
dmRoX2ZsaWNrcl90aHVtYm5haWxzX251bWJlcl9vZl9waG90b3MoKSB7CglnbG9iYWwgJHRo
dW1iczsKCXJldHVybiAkdGh1bWJzLT50aHVtYm5haWxzX251bWJlcl9vZl9waG90b3MoKTsK
fQoKZnVuY3Rpb24gdmRoX2ZsaWNrcl90aHVtYm5haWxzX3Blcl9wYWdlKCkgewoJZ2xvYmFs
ICR0aHVtYnM7CglyZXR1cm4gJHRodW1icy0+dGh1bWJuYWlsc19wZXJfcGFnZSgpOwp9Cgpm
dW5jdGlvbiB2ZGhfZmxpY2tyX3RodW1ibmFpbHNfY3VycmVudF9wYWdlKCkgewoJZ2xvYmFs
ICR0aHVtYnM7CglyZXR1cm4gJHRodW1icy0+dGh1bWJuYWlsc19jdXJyZW50X3BhZ2UoKTsK
fQoKZnVuY3Rpb24gdmRoX2ZsaWNrcl90aHVtYm5haWxzX3RvdGFsX3BhZ2VzKCkgewoJZ2xv
YmFsICR0aHVtYnM7CglyZXR1cm4gJHRodW1icy0+dGh1bWJuYWlsc190b3RhbF9wYWdlcygp
Owp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX3RodW1ibmFpbHNfcGFnZXNfZmlyc3QoJHBhcmFt
cywgJHRoaW5nKSB7CglnbG9iYWwgJHRodW1iczsKCXJldHVybiAkdGh1bWJzLT50aHVtYm5h
aWxzX3BhZ2VzX2ZpcnN0KCR0aGluZyk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfdGh1bWJu
YWlsc19wYWdlc19sYXN0KCRwYXJhbXMsICR0aGluZykgewoJZ2xvYmFsICR0aHVtYnM7Cgly
ZXR1cm4gJHRodW1icy0+dGh1bWJuYWlsc19wYWdlc19sYXN0KCR0aGluZyk7Cn0KCmZ1bmN0
aW9uIHZkaF9mbGlja3JfdGh1bWJuYWlsc19wYWdlc19wcmV2aW91cygkcGFyYW1zLCAkdGhp
bmcpIHsKCWdsb2JhbCAkdGh1bWJzOwoJcmV0dXJuICR0aHVtYnMtPnRodW1ibmFpbHNfcGFn
ZXNfcHJldmlvdXMoJHRoaW5nKTsKfQoKZnVuY3Rpb24gdmRoX2ZsaWNrcl90aHVtYm5haWxz
X3BhZ2VzX25leHQoJHBhcmFtcywgJHRoaW5nKSB7CglnbG9iYWwgJHRodW1iczsKCXJldHVy
biAkdGh1bWJzLT50aHVtYm5haWxzX3BhZ2VzX25leHQoJHRoaW5nKTsKfQoKZnVuY3Rpb24g
dmRoX2ZsaWNrcl90aHVtYm5haWxzX3BhZ2VzX2xpc3QoJHBhcmFtcykgewoJZ2xvYmFsICR0
aHVtYnM7CglyZXR1cm4gJHRodW1icy0+dGh1bWJuYWlsc19wYWdlc19saXN0KCRwYXJhbXMp
Owp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX3RodW1ibmFpbHNfcGFnZXNfc3RhcnR0aHVtYigp
IHsKCWdsb2JhbCAkdGh1bWJzOwoJcmV0dXJuICR0aHVtYnMtPnRodW1ibmFpbHNfcGFnZXNf
c3RhcnR0aHVtYigpOwp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX3RodW1ibmFpbHNfcGFnZXNf
ZW5kdGh1bWIoKSB7CglnbG9iYWwgJHRodW1iczsKCXJldHVybiAkdGh1bWJzLT50aHVtYm5h
aWxzX3BhZ2VzX2VuZHRodW1iKCk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfdGh1bWJuYWls
c19pZl9tdWx0aXBsZV9wYWdlcygkcGFyYW1zLCAkdGhpbmcpIHsKCWdsb2JhbCAkdGh1bWJz
OwoJcmV0dXJuICR0aHVtYnMtPnRodW1ibmFpbHNfaWZfbXVsdGlwbGVfcGFnZXMoJHRoaW5n
KTsKfQoKZnVuY3Rpb24gdmRoX2ZsaWNrcl9pbWdfdGl0bGUgKCkgewoJZ2xvYmFsICRzaW5n
bGVpbWc7CglyZXR1cm4gJHNpbmdsZWltZy0+aW1nX3RpdGxlKCk7Cn0KCmZ1bmN0aW9uIHZk
aF9mbGlja3JfaW1nX2Rlc2NyaXB0aW9uICgpIHsKCWdsb2JhbCAkc2luZ2xlaW1nOwoJcmV0
dXJuICRzaW5nbGVpbWctPmltZ19kZXNjcmlwdGlvbigpOwp9CgpmdW5jdGlvbiB2ZGhfZmxp
Y2tyX2ltZ19pZl9kZXNjcmlwdGlvbiAoJHBhcmFtcywgJHRoaW5nKSB7CglnbG9iYWwgJHNp
bmdsZWltZzsKCXJldHVybiAkc2luZ2xlaW1nLT5pbWdfaWZfZGVzY3JpcHRpb24oJHRoaW5n
KTsKfQoKZnVuY3Rpb24gdmRoX2ZsaWNrcl9pbWdfbmFrZWQgKCkgewoJZ2xvYmFsICRzaW5n
bGVpbWc7CglyZXR1cm4gJHNpbmdsZWltZy0+aW1nX25ha2VkKCk7Cn0KCmZ1bmN0aW9uIHZk
aF9mbGlja3JfaW1nX2xpbmsgKCRwYXJhbXMsICR0aGluZykgewoJJHJlc3VsdCA9IHBhcnNl
KCR0aGluZyk7CglnbG9iYWwgJHNpbmdsZWltZzsKCXJldHVybiAkc2luZ2xlaW1nLT5pbWdf
bGluaygkcmVzdWx0KTsKfQoKZnVuY3Rpb24gdmRoX2ZsaWNrcl9pbWdfcHJldmlvdXMgKCRw
YXJhbXMsICR0aGluZykgewoJJHJlc3VsdCA9IHBhcnNlKCR0aGluZyk7CglnbG9iYWwgJHNp
bmdsZWltZzsKCXJldHVybiAkc2luZ2xlaW1nLT5pbWdfcHJldmlvdXMoJHBhcmFtc1snbGFi
ZWwnXSwgJHJlc3VsdCk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaW1nX3ByZXZpb3VzX3Ro
dW1ibmFpbCAoKSB7CglnbG9iYWwgJHNpbmdsZWltZzsKCXJldHVybiAkc2luZ2xlaW1nLT5p
bWdfcHJldmlvdXNfdGh1bWJuYWlsKCk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaW1nX25l
eHQgKCRwYXJhbXMsICR0aGluZykgewoJJHJlc3VsdCA9IHBhcnNlKCR0aGluZyk7CglnbG9i
YWwgJHNpbmdsZWltZzsKCXJldHVybiAkc2luZ2xlaW1nLT5pbWdfbmV4dCgkcGFyYW1zWyds
YWJlbCddLCAkcmVzdWx0KTsKfQoKZnVuY3Rpb24gdmRoX2ZsaWNrcl9pbWdfbmV4dF90aHVt
Ym5haWwgKCkgewoJZ2xvYmFsICRzaW5nbGVpbWc7CglyZXR1cm4gJHNpbmdsZWltZy0+aW1n
X25leHRfdGh1bWJuYWlsKCk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaW1nX3NldF90aXRs
ZSAoKSB7CglnbG9iYWwgJHNpbmdsZWltZzsKCXJldHVybiAkc2luZ2xlaW1nLT5pbWdfc2V0
X3RpdGxlKCk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaW1nX3NldF9saW5rICgkcGFyYW1z
LCAkdGhpbmcpIHsKCSRyZXN1bHQgPSBwYXJzZSgkdGhpbmcpOwoJZ2xvYmFsICRzaW5nbGVp
bWc7CglyZXR1cm4gJHNpbmdsZWltZy0+aW1nX3NldF9saW5rKCRyZXN1bHQpOwp9CgpmdW5j
dGlvbiB2ZGhfZmxpY2tyX2ltZ190YWdzICgkcGFyYW1zKSB7CglnbG9iYWwgJHNpbmdsZWlt
ZzsKCXJldHVybiAkc2luZ2xlaW1nLT5pbWdfdGFncygkcGFyYW1zWydzZXBhcmF0b3InXSk7
Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaW1nX251bWJlcl9vZl9jb21tZW50cyAoKSB7Cgln
bG9iYWwgJHNpbmdsZWltZzsKCXJldHVybiAkc2luZ2xlaW1nLT5pbWdfbnVtYmVyX29mX2Nv
bW1lbnRzKCk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaW1nX2NvbW1lbnRzX2ludml0ZSAo
JHBhcmFtcywgJHRoaW5nKSB7CgkkcmVzdWx0ID0gcGFyc2UoJHRoaW5nKTsKCWdsb2JhbCAk
c2luZ2xlaW1nOwoJcmV0dXJuICRzaW5nbGVpbWctPmltZ19jb21tZW50c19pbnZpdGUoJHJl
c3VsdCk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaW1nX2RhdGVfcG9zdGVkICgkcGFyYW1z
KSB7CglnbG9iYWwgJHNpbmdsZWltZzsKCXJldHVybiAkc2luZ2xlaW1nLT5pbWdfZGF0ZV9w
b3N0ZWQoJHBhcmFtcyk7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaW1nX2RhdGVfdGFrZW4g
KCRwYXJhbXMpIHsKCWdsb2JhbCAkc2luZ2xlaW1nOwoJcmV0dXJuICRzaW5nbGVpbWctPmlt
Z19kYXRlX3Rha2VuKCRwYXJhbXMpOwp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX2VudigkcGFy
YW1zKSB7CglnbG9iYWwgJHZkaF9mbGlja3I7CglpZihpc3NldCgkX0dFVFsnaW1nJ10pKSB7
CgkJZ2xvYmFsICRzaW5nbGVpbWc7CgkJJHZkaF9mbGlja3JbJ2lzX2ltZyddID0gMTsKCQkk
c2luZ2xlaW1nID0gbmV3IFBpY3R1cmUoJHBhcmFtcyk7CgkJcmV0dXJuICcnOwoJfQoJaWYo
aXNzZXQoJF9HRVRbJ3RhZ3MnXSkpIHsKCQlnbG9iYWwgJHRodW1iczsKCQkkdmRoX2ZsaWNr
clsnaXNfdGh1bWJuYWlscyddID0gMTsKCQkkdmRoX2ZsaWNrclsnaXNfdGFncyddID0gMTsK
CQkkdGh1bWJzID0gbmV3IFRodW1ibmFpbHMoJHBhcmFtcyk7CgkJcmV0dXJuICcnOwoJfQoJ
aWYoaXNzZXQoJF9HRVRbJ3NldCddKSkgewoJCWdsb2JhbCAkdGh1bWJzOwoJCSR2ZGhfZmxp
Y2tyWydpc190aHVtYm5haWxzJ10gPSAxOwoJCSR2ZGhfZmxpY2tyWydpc19zZXQnXSA9IDE7
CgkJJHRodW1icyA9IG5ldyBUaHVtYm5haWxzKCRwYXJhbXMpOwoJCXJldHVybiAnJzsKCX0K
CWdsb2JhbCAkZ2FsOwoJKChpc3NldCAoJGdhbCkpPT1mYWxzZSk/ICRnYWwgPSBuZXcgR2Fs
bGVyeSgkcGFyYW1zKSA6ICcnOwoJJHZkaF9mbGlja3JbJ2lzX3ByZXZpZXcnXSA9IDE7Cgly
ZXR1cm4gJyc7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaWZfcHJldmlldygkcGFyYW1zLCAk
dGhpbmcpIHsKCWdsb2JhbCAkdmRoX2ZsaWNrcjsKCXJldHVybiAoQCR2ZGhfZmxpY2tyWydp
c19wcmV2aWV3J10gPT0gdHJ1ZSkgPyBwYXJzZSgkdGhpbmcpIDogJyc7Cn0KCmZ1bmN0aW9u
IHZkaF9mbGlja3JfaWZfdGh1bWJuYWlscygkcGFyYW1zLCAkdGhpbmcpIHsKCWdsb2JhbCAk
dmRoX2ZsaWNrcjsKCXJldHVybiAoQCR2ZGhfZmxpY2tyWydpc190aHVtYm5haWxzJ10gPT0g
dHJ1ZSkgPyBwYXJzZSgkdGhpbmcpIDogJyc7Cn0KCmZ1bmN0aW9uIHZkaF9mbGlja3JfaWZf
c2V0KCRwYXJhbXMsICR0aGluZykgewoJZ2xvYmFsICR2ZGhfZmxpY2tyOwoJcmV0dXJuIChA
JHZkaF9mbGlja3JbJ2lzX3NldCddID09IHRydWUpID8gcGFyc2UoJHRoaW5nKSA6ICcnOwp9
CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX2lmX3RhZ3MoJHBhcmFtcywgJHRoaW5nKSB7CglnbG9i
YWwgJHZkaF9mbGlja3I7CglyZXR1cm4gKEAkdmRoX2ZsaWNrclsnaXNfdGFncyddID09IHRy
dWUpID8gcGFyc2UoJHRoaW5nKSA6ICcnOwp9CgpmdW5jdGlvbiB2ZGhfZmxpY2tyX2lmX2lt
ZygkcGFyYW1zLCAkdGhpbmcpIHsKCWdsb2JhbCAkdmRoX2ZsaWNrcjsKCXJldHVybiAoQCR2
ZGhfZmxpY2tyWydpc19pbWcnXSA9PSB0cnVlKSA/IHBhcnNlKCR0aGluZykgOiAnJzsKfQoK
ZnVuY3Rpb24gdmRoX2ZsaWNrcl9zaG93X25zaWQoJHBhcmFtcykgewoJJG5zaWRjaGVjayA9
IG5ldyBWZGhfZmxpY2tyKCRwYXJhbXMpOwoJcmV0dXJuICRuc2lkY2hlY2stPl9fdG9TdHJp
bmcoKTsKfSI7czozOiJtZDUiO3M6MzI6IjVjMDdkZDk3ZDgxYTkwYzljZGUzOGYyYjAzMmQ1
Yjc2Ijt9
